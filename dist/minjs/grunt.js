var lang_type,underIE8=!1;if(function(){if(lang_type=Ext.util.Cookies.get("ws_language")){if("0"==lang_type)return void document.write('<script type="text/javascript" src="/dist/ext4/locale/ext-lang-zh_CN.js"></script>');if("1"==lang_type)return void document.write('<script type="text/javascript" src="/dist/ext4/locale/ext-lang-en.js"></script>');lang_type="0",document.write('<script type="text/javascript" src="/dist/ext4/locale/ext-lang-zh_CN.js"></script>')}else lang_type="0",document.write('<script type="text/javascript" src="/dist/ext4/locale/ext-lang-zh_CN.js"></script>')}(),Ext.isIE&&Ext.ieVersion<8)if(window.attachEvent&&!window.opera){alert("Your IE version is unsupported, please use IE8/9.");var loadingDiv=document.getElementById("loadingDiv");loadingDiv&&document.body.removeChild(loadingDiv),document.execCommand("stop")}else{alert("Your IE version is unsupported, please use IE8/9.");var loadingDiv=document.getElementById("loadingDiv");loadingDiv&&document.body.removeChild(loadingDiv),window.stop()}
//# sourceMappingURL=locale.js.map
var login_sessiontoken=Ext.util.Cookies.get("login_sessiontoken"),login_username=Ext.util.Cookies.get("login_username"),login_password=Ext.util.Cookies.get("login_password"),login_checksavepass=Ext.util.Cookies.get("login_checksavepass");Ext.namespace("GlobalFun","GlobalFun"),Ext.namespace("StoreManager","StoreManager.GridStore"),Ext.namespace("StoreManager","StoreManager.ComboStore"),Ext.namespace("ModelManager","ModelManager.GridModel"),Ext.namespace("ModelInfoManager","ModelInfoManager.GridModelInfo"),Ext.namespace("GridManager","GridManager"),Ext.namespace("WindowManager","WindowManager"),Ext.namespace("ActionManager","ActionManager"),Ext.namespace("GlobalConfig","GlobalConfig"),Ext.namespace("DropDragControl","DropDragControl"),Ext.namespace("Template","Template"),GlobalConfig.ViewPort="",GlobalConfig.GridPageSize=50,GlobalConfig.MaxLimit=99999,Ext.namespace("TreeManager","TreeManager"),GlobalConfig.DetailAutoCollapse=!1,GlobalConfig.CurrUserInfo="",GlobalConfig.Css={RemarkDisplay:"white-space:normal; word-break:break-all;",RemarkReadOnlyDisplay:"white-space:normal; word-break:break-all;readonly:true;"},GlobalConfig.HeartbeatRunner=new Ext.util.TaskRunner,GlobalConfig.newMessageBox=Ext.create("Ext.window.MessageBox",{});var globalFix="/data";GlobalConfig.Controllers={TestGrid:{create:"/data/TestGrid.json",read:"/data/TestGrid.json",update:"/data/TestGrid.json",destroy:"/data/TestGrid.json"},Heartbeat:"login/heartbeat",User:{GetCurrUserInfo:"/login/ajaxLogin",CheckUserPassword:"/CheckUserPassword111",UserLoginOut:"/data/UserLoginOut.json"},UserGrid:{},CustomerGrid:{create:globalFix+"/CustomerGrid.json",read:"customer/getList",update:"customer/update",destroy:globalFix+"/CustomerGrid.json",loadRuleCount:globalFix+"/loadRuleCount.json",addCustomer:"/customer/add",updateCustomer:globalFix+"/UpdateCustomer.json",addCustomerRent:"/customerRent/add",addCustomerRule:"customerExpressRule/addRule",delCustomerRule:"customerExpressRule/deleteRule",delCustomer:globalFix+"/DelCustomer.json",GetCustomerRuleByRentId:"customerExpressRule/countProvinceRule",getCustomerRule:"customerExpressRule/show",uploadCustomerExcel:globalFix+"/UploadCustomerExcel.json"},Customer_numberGrid:{create:"customerNumber/add",read:"customerNumber/getList",update:"customerNumber/update",destroy:"customerNumber/delete"},CustomerRentGrid:{create:"/customerRent/add",read:"/customerRent/getList",update:globalFix+"/CustomerRentGrid.json",destroy:globalFix+"/CustomerRentGrid.json"},ExpressPanel:{GetCustomer_numberCount:"expressRule/countProvinceRule",GetExpressRule:"expressRule/show",delExpressRule:"expressRule/deleteRule",addExpressRule:"expressRule/addRule"},Tracking_numberGrid:{create:globalFix+"/traking_numberGrid.json",read:"trackingNumber/getList",update:globalFix+"/traking_numberGrid.json",destroy:globalFix+"/traking_numberGrid.json",uploadExcel:"/uploadTrackingNumber/upload",outPutExcel:globalFix+"/outPutExcel"},MainItemListTree:"/data/LoadMainItemListTree.json"},GlobalConfig.RegexController={regexNumber:/^\d*$/,regexNumberF:/^([-]\d*|\d*)$/,regexAlphabetNumber:/^(\d|[A-Za-z])*$/,regexTelePhoneNumber:/^\d{11}$/,regexFaxNumber:/(^sip\:[0-9a-zA-Z#-_]+@[0-9a-zA-Z.-_]+$)|(^\d+-(\d|\#|\*)*$)|(^\(\d+\)(\d|\#|\*)*$)|(^\+[\d][123457890](\d*) (\d|\#|\*)+$)|(^\+[123456790][\d](\d*) (\d|\#|\*)+$)|(^\+[1] (\d|\#|\*)+$)|(^\+[7] (\d|\#|\*)+$)|(^\+[\d][6](\d+) (\d|\#|\*)+$)|(^\+(\d+)\(\d+\)(\d|\#|\*)+$)|(^(0+[1-9]\d{2,})$)|(^\d+$)/,regexFolderName:/^[^\\\/?: *"<>|]+$/,regexEmail:/^(\w|\.)+\@\w+\.\w+$/,regexTombstoneCode:/^(\d{3}|\d{5}|\d{7})$/,regexAreaCode:/^\d{3}$/,regexMoney2Fixed:/^[0-9]\d{0,7}((\.)?\d{1,2})?$/,regexMoney3Fixed:/^[0-9]\d{0,8}((\.)?\d{1,3})?$/},GlobalConfig.ErrorCode={RootFolderID:0,RecycleFolderID:1073741822,PublicRootFolderID:2147483632,PublicRecycleFolderID:2147483646,DontCareFolderID:1073741823,ResOK:0,ResFullPrint:24,ResPartialOK:251658241,ResSessionTokenError:251658242,ResSessionTimeOut:251658244,ResOperationDeny:251658248,ResDBError:251658249,ResInternalError:251658256,ResParamError:251658257,ResSystemError:251658260,ResInputParamsError:251658264,ResConnectServerFailed:251658265,ResOperationNoSense:251658272,ResHasNotImplement:251658273,ConServerError:1879048187,CasLogoutCode:1879048190,ResNoUserName:251658512,ResPasswordError:251658513,LoginFail:251658514,ResUserInvalid:251658515,ResDomainLoginFailed:251658516,ResInvalidFolderID:251658288,ResFolderTypeNotMatch:251658290,ResDupFolderName:251658291,ResFolderNotEmpty:251658292,ResTooManyFolders:251658296,ResInvalidDocID:251661873,ResInvalidDocInfo:251661874,SeesionTimeOut:99},GlobalConfig.Province={110000:"北京市",120000:"天津市",130000:"河北省",140000:"山西省",150000:"内蒙古自治区",210000:"辽宁省",220000:"吉林省",230000:"黑龙江省",310000:"上海市",320000:"江苏省",330000:"浙江省",340000:"安徽省",350000:"福建省",360000:"江西省",370000:"山东省",410000:"河南省",420000:"湖北省",430000:"湖南省",440000:"广东省",450000:"广西壮族自治区",460000:"海南省",500000:"重庆市",510000:"四川省",520000:"贵州省",530000:"云南省",540000:"西藏自治区",610000:"陕西省",620000:"甘肃省",630000:"青海省",640000:"宁夏回族自治区",650000:"新疆维吾尔自治区",710000:"台湾省",810000:"香港特别行政区",820000:"澳门特别行政区"},GlobalConfig.globalStatus={};
//# sourceMappingURL=GlobalConfig.js.map
GlobalFun.fixedBugs=function(){if(Ext.firefoxVersion>=18){var noArgs=[];Ext.override(Ext.Base,{callParent:function(args){var method,superMethod=(method=this.callParent.caller)&&(method.$previous||(method=method.$owner?method:method.caller)&&method.$owner.superclass[method.$name]);try{if(!superMethod){method=this.callParent.caller;var parentClass,methodName;if(!method.$owner){if(!method.caller)throw new Error("Attempting to call a protected method from the public scope, which is not allowed");method=method.caller}if(parentClass=method.$owner.superclass,methodName=method.$name,!(methodName in parentClass))throw new Error("this.callParent() was called but there's no such method ("+methodName+") found in the parent class ("+(Ext.getClassName(parentClass)||"Object")+")")}}catch(e){}return superMethod.apply(this,args||noArgs)}})}Ext.isIE&&Ext.override(Ext.dd.DragDropManager,{getLocation:function(oDD){if(!this.isTypeOfDD(oDD))return null;if(oDD.getRegion)return oDD.getRegion();var pos,x1,x2,y1,y2,t,r,b,l,el=oDD.el;try{pos=Ext.Element.getXY(el)}catch(e){}return pos?(x1=pos[0],x2=x1+77,y1=pos[1],y2=y1+60,t=y1-oDD.padding[0],r=x2+oDD.padding[1],b=y2+oDD.padding[2],l=x1-oDD.padding[3],new Ext.util.Region(t,r,b,l)):null}}),Ext.ouveride,Ext.override(Ext.view.AbstractView,{onRender:function(){var me=this;me.callParent(arguments),me.loadMask&&Ext.isObject(me.store)&&me.setMaskBind(me.store)}}),GlobalConfig.newMessageBox.buttonText.yes="是",GlobalConfig.newMessageBox.buttonText.no="否",GlobalConfig.newMessageBox.buttonText.ok="确定",GlobalConfig.newMessageBox.buttonText.cancel="取消",Ext.override(Ext.window.MessageBox,{alert:function(cfg,msg,fn,scope){return Ext.isString(cfg)&&(cfg={title:cfg,msg:msg,buttons:this.OK,fn:fn,scope:scope,minWidth:this.minWidth<330?330:this.minWidth}),this.show(cfg)}}),Ext.apply(Ext.form.field.VTypes,{daterange:function(val,field){var date=field.parseDate(val);if(!date)return!1;if(!field.startDateField||field.dateRangeMax&&date.getTime()==field.dateRangeMax.getTime()){if(field.endDateField&&(!field.dateRangeMin||date.getTime()!=field.dateRangeMin.getTime())){var end=field.up("panel").down("#"+field.endDateField);end.setMinValue(date),end.validate(),field.dateRangeMin=date}}else{var start=field.up("panel").down("#"+field.startDateField);start.setMaxValue(date),start.validate(),field.dateRangeMax=date}return!0},daterangeText:"起始时间不能大于截止时间"})},GlobalFun.ReDirectUrl=function(url){var protocol=window.location.protocol,host=window.location.host;window.location.href=protocol+"//"+host+"/"+url},GlobalFun.getSeesionToken=function(){return Ext.util.Cookies.get("login_sessiontoken")},GlobalFun.setSeesionToken=function(sessiontoken,day){var myday=30;day&&(myday=day),Ext.util.Cookies.set("login_sessiontoken",sessiontoken,new Date((new Date).getTime()+864e5*myday))},GlobalFun.UpdateRecord=function(value,metaData,record,rowIndex,colIndex,store,view){return value},GlobalFun.UpdateRecordForShortDate=function(value,metaData,record,rowIndex,colIndex,store,view){var date=new Date(value.replace(/-/g,"/"));return Ext.util.Format.date(date,"Y-m-d")},GlobalFun.UpdateRecordForEntity=function(value,metaData,record,rowIndex,colIndex,store,view,disName){return value&&null!=value?disName?GlobalFun.UpdateRecord(value[disName],metaData,record):GlobalFun.UpdateRecord(value.Name,metaData,record):GlobalFun.UpdateRecord("",metaData,record)},GlobalFun.UTCtoLocal=function(dateString){var date=Ext.Date.parse(dateString+"+0000","Y-m-d H:i:sO"),m=Ext.util.Format.date(date,"Y-m-d H:i:s");return m},GlobalFun.LocalToUTCTime=function(i,endTime){var now=new Date,nowStr=Ext.util.Format.date(now,"Y-m-d"),offset=60*now.getTimezoneOffset()*1e3,resDate=new Date;if(endTime){var nowDay=Ext.Date.parse(nowStr+" 23:59:59","Y-m-d H:i:s");resDate.setTime(nowDay.getTime()+offset)}else{var nowDay=Ext.Date.parse(nowStr+" 00:00:00","Y-m-d H:i:s");resDate.setTime(nowDay.getTime()+offset-24*i*3600*1e3)}return Ext.util.Format.date(resDate,"Y-m-d H:i:s")},GridManager.BaseGridCfg=function(itemId,stateId,columns){var config={itemId:itemId,columnLines:!0,multiSelect:!0,frame:!1,stateful:stateId?!0:!1,border:!1};return stateId&&(config.stateId=stateId),columns&&(config.columns=columns),config},GlobalFun.errorProcess=function(code,swfokfun){return code==GlobalConfig.ErrorCode.LoginFail?(Ext.Msg.alert("登录失败","登录失败！无效用户名或密码",function(){swfokfun&&swfokfun()}),!0):code==GlobalConfig.ErrorCode.SeesionTimeOut?(Ext.getBody().unmask(),Ext.Msg.alert("登录信息失效","登录信息失效！请重新登录",function(){Ext.getBody().mask("请稍候..."),GlobalFun.ReDirectUrl("login.html")}),!0):!1},GlobalFun.isDropTarget=function(record,treeComponent){var treeSel=treeComponent.getSelectionModel().getSelection()[0];return treeSel.data.id==record.data.id?!1:-1!=treeSel.data.id.toString().indexOf("trwr")?!1:!0},GlobalFun.treeInternational=function(treeId){return"gr"==treeId?"个人":"tr"==treeId?"他人":""},GlobalFun.owerInternational=function(srcStr){return srcStr=srcStr.replace("@shoujianxiang@","收件箱").replace("@gxsjx@","共享收件箱").replace("@gr@","个人").replace("@gxwjj@","共享文件夹").replace("@gx@","共享")},GlobalFun.comboSelectFirstOrDefaultVal=function(com,defaultVal){var store=com.getStore();defaultVal?(new Ext.util.DelayedTask).delay(50,function(){com.setValue(parseInt(defaultVal))}):com.setValue(store.getRange()[0].data.Id)},GridManager.GridFilterMenuCheckItemInit=function(param){var menuCheckItem={group:param.group,text:param.text,myVal:param.myVal};return param.checked&&(menuCheckItem.checked=!0),param.firstClear?menuCheckItem.handler=function(btn,eve,suppressLoad){var panel=param.target,menu=param.componet;return menu.setText(param.text),menu.setTooltip(param.text),panel.getStore().filterMap.removeAtKey(param.filterKey),suppressLoad?void this.setChecked(suppressLoad):void panel.loadGrid()}:menuCheckItem.handler=function(btn,eve,suppressLoad){var panel=param.target,menu=param.componet;return menu.setText(param.text),menu.setTooltip(param.text),panel.getStore().filterMap.containsKey(param.filterKey)?panel.getStore().filterMap.replace(param.filterKey,param.myVal):panel.getStore().filterMap.add(param.filterKey,param.myVal),suppressLoad?void this.setChecked(suppressLoad):void panel.loadGrid()},menuCheckItem},GridManager.CreateGridFilterMenu=function(componet,store,param){componet.menu.add(GridManager.GridFilterMenuCheckItemInit({group:param.group,checked:!0,text:param.text,myVal:0,target:param.target,componet:param.componet,firstClear:!0,filterKey:param.filterKey})),store.each(function(record,index,total){componet.menu.add(GridManager.GridFilterMenuCheckItemInit({group:param.group,text:record.data.Name,myVal:record.data.Id,target:param.target,componet:param.componet,filterKey:param.filterKey}))})},GridManager.CreateGridSelectCancelMenu=function(componet,grid){componet.menu.add([{text:"全选/取消",handler:function(btn,eve,suppressLoad){var sm=grid.getSelectionModel();sm.hasSelection()?sm.deselectAll(!0):sm.selectAll(!0)}},{text:"反选",handler:function(btn,eve,suppressLoad){for(var sm=grid.getSelectionModel(),i=0;i<grid.getStore().getCount();i++)sm.isSelected(i)?sm.deselect(i,!0):sm.select(i,!0)}}])};var stopClick=!1;DropDragControl.initializePatientDragZone=function(v,window){v.dragZone=Ext.create("Ext.dd.DragZone",v.getEl(),{ddGroup:window.groupName,isTarget:!1,getDragData:function(e){var sourceEl=e.getTarget();if(sourceEl){var selCount;selCount=window.pngClass.getPngSels().getCount();var oNewNode=document.createElement("div");return oNewNode.innerHTML="<span><img src='../../Content/images/pub/docDrag.png'/>x"+selCount+"</span>",oNewNode.id=Ext.id(),v.dragData={sourceEl:sourceEl,repairXY:Ext.fly(sourceEl).getXY(),ddel:oNewNode,patientData:""}}},getRepairXY:function(){return this.dragData.repairXY},endDrag:function(){stopClick=!0,new Ext.util.DelayedTask(function(){stopClick=!1}).delay(50)},onInvalidDrop:function(target,e,id){this.beforeInvalidDrop(target,e,id),this.cachedTarget&&(this.cachedTarget.isNotifyTarget&&this.cachedTarget.notifyOut(this,e,this.dragData),this.cacheTarget=null),this.proxy.repair(this.getRepairXY(e,this.dragData),this.afterRepair,this),this.afterInvalidDrop&&this.afterInvalidDrop(e,id)}})},DropDragControl.uninitPatientDragZone=function(v){v.dragZone&&v.dragZone.destroy()},DropDragControl.uninitHospitalDropZone=function(v){v.dropZone&&v.dropZone.destroy()},DropDragControl.initializeHospitalDropZone=function(v,window){v.dropZone=Ext.create("Ext.dd.DropZone",v.el,{ddGroup:window.groupName,getTargetFromEvent:function(e){return e.getTarget(".hospital-target")},onNodeOver:function(target,dd,e,data){return Ext.dd.DropZone.prototype.dropAllowed},onNodeDrop:function(target,dd,e,data){var curImg,pngClass=window.pngClass;pngClass.getPngAllMini().each(function(item,index,allItems){return item.getEl()&&item.getEl().id==target.id?void(curImg=item):void 0});var sortNum=curImg.sortNum,insertImgs=(curImg.tombstoneId,[]),moveFrontImg=[],moveBehindImgs=[],insertCount=parseInt(sortNum),imageList=window.down("MiniPngDDSortPanel").query("image");e.getPoint()[0]-curImg.getEl().getXY()[0]<=target.offsetWidth/2?(pngClass.getPngSels().each(function(item,index,allItems){insertImgs.push(item.tombstoneId)}),Ext.Array.each(imageList,function(item,index,allItems){item.sortNum<insertCount&&(Ext.Array.contains(insertImgs,item.tombstoneId)||moveFrontImg.push(item.tombstoneId))}),Ext.Array.each(imageList,function(item,index,allItems){item.sortNum>=insertCount&&(Ext.Array.contains(insertImgs,item.tombstoneId)||moveBehindImgs.push(item.tombstoneId))})):(pngClass.getPngSels().each(function(item,index,allItems){insertImgs.push(item.tombstoneId)}),Ext.Array.each(imageList,function(item,index,allItems){item.sortNum<=insertCount&&(Ext.Array.contains(insertImgs,item.tombstoneId)||moveFrontImg.push(item.tombstoneId))}),Ext.Array.each(imageList,function(item,index,allItems){item.sortNum>insertCount&&(Ext.Array.contains(insertImgs,item.tombstoneId)||moveBehindImgs.push(item.tombstoneId))}));var tombstoneIdList=moveFrontImg.concat(insertImgs,moveBehindImgs),param={};return param.tombstoneIdList=tombstoneIdList.join(),param.sessiontoken=Ext.util.Cookies.get("sessiontoken"),WsCall.call(GlobalConfig.Controllers.TombstoneGrid.SortTombstonePng,"SortTombstonePng",param,function(response,opts){var area=window.down("#AreaIdItemId"),row=window.down("#RowIdItemId");if(area.isValid()&&row.isValid()){pngClass.setAreaId(area.getValue()),pngClass.setRowId(row.getValue());var miniPngDDSortPanel=window.down("MiniPngDDSortPanel");miniPngDDSortPanel.removeAll(),pngClass.initPngPanel(miniPngDDSortPanel)}},function(response,opts){GlobalFun.errorProcess(response.code)||Ext.Msg.alert("失败",response.msg)},!0,"请稍候...",window.el),!0}})},GlobalFun.SetGridTitle=function(cardPanel,store,title){store.filterMap.getCount()>0||store.getProxy().extraParams.DateFilter?cardPanel.setTitle("查找结果 { "+title+" }"):cardPanel.setTitle(""+title)},GlobalFun.TreeSelChangeGrid=function(activeNum,gridPanel,title,isDfGrid){var cardPanel=GlobalConfig.ViewPort.down("#centerGridDisplayContainer");return cardPanel.getLayout().setActiveItem(activeNum),isDfGrid?void cardPanel.setTitle(""+title):(gridPanel.FirstLoad?GlobalFun.SetGridTitle(cardPanel,gridPanel.getStore(),title):(gridPanel.loadGrid(),gridPanel.FirstLoad=!0,GlobalFun.SetGridTitle(cardPanel,gridPanel.getStore(),title)),void gridPanel.fireEvent("selectionchange",gridPanel.getView(),gridPanel.getSelectionModel().getSelection()))},GlobalFun.ValidDateStartEnd=function(dateStarField,dateEndField){var sVal=dateStarField.getValue(),eVal=dateEndField.getValue();sVal&&!eVal?(dateEndField.allowBlank=!1,dateEndField.blankText="日期区间必须完整"):eVal&&!sVal?(dateStarField.allowBlank=!1,dateStarField.blankText="日期区间必须完整"):(dateEndField.allowBlank=!0,dateStarField.allowBlank=!0)},GlobalFun.onCheckChange=function(cmp,checked){var fieldset=cmp.up("fieldset");if(!fieldset.fistCheck){var cblist=fieldset.query("checkbox");Ext.Array.each(cblist,function(item){item.setValue(checked)})}},GlobalFun.createCheckboxCmp=function(){var me=this,suffix="-checkbox";return me.checkboxCmp=Ext.widget({xtype:"checkbox",hideEmptyLabel:!0,name:me.checkboxName||me.id+suffix,cls:me.baseCls+"-header"+suffix,itemId:me.myItemId,id:me.id+"-legendChk",listeners:{change:me.onCheckChange,scope:me}}),me.checkboxCmp},GlobalFun.Heartbeat=function(){new Ext.util.DelayedTask(function(){GlobalConfig.HeartbeatRunner.stopAll(),GlobalConfig.HeartbeatRunner.start({run:function(){var param={sessiontoken:GlobalFun.getSeesionToken()};WsCall.call(GlobalConfig.Controllers.Heartbeat,"Heartbeat",param,function(response,opts){},function(response,opts){},!1)},interval:6e5})}).delay(50)},GlobalFun.IsAllowFun=function(funName){var flag=!1;return flag=!0},GlobalFun.GridSearchInitFun=function(keyName,isDel,store,value){isDel?store.filterMap.removeAtKey(keyName):store.filterMap.containsKey(keyName)?store.filterMap.replace(keyName,value):store.filterMap.add(keyName,value)},GlobalFun.GetTomestoneImageSrc=function(state,tombstoneId,typeId){var imgaeName="alone";return 2==typeId?imgaeName="double":3==typeId&&(imgaeName="specil"),imgaeName+=1==state?"-empty":2==state?"-order":3==state?"-sale":4==state?"-zbury1":5==state?2==typeId?"-zbury3":"-zbury":"-empty","../../Content/images/tombstone/gif/"+imgaeName+".gif?currpage="+tombstoneId+"&randomTime="+(new Date).getTime()},GlobalFun.RefreshDetailCollapseState=function(){if(GlobalConfig.DetailAutoCollapse){var detailPanel=GlobalConfig.ViewPort.down("#centerGridDetailContainer");detailPanel.expand(),GlobalConfig.DetailAutoCollapse=!1}},GlobalFun.DetailCollapse=function(){var detailPanel=GlobalConfig.ViewPort.down("#centerGridDetailContainer");detailPanel.collapsed||(detailPanel.collapse(),GlobalConfig.DetailAutoCollapse=!0)},GlobalFun.JsonToArray=function(json){var arr=[];for(key in json){var obj={Id:key,Name:json[key]};arr.push(obj)}return arr};
//# sourceMappingURL=GlobalFun.js.map
Ext.define("chl.grid.BaseGrid",{alternateClassName:["BaseGrid"],alias:"widget.BaseGrid",extend:"Ext.grid.Panel",columnLines:!0,multiSelect:!0,features:[{ftype:"grouping",groupHeaderTpl:"{columnName}: {name} ({rows.length})项",disabled:!0,groupByText:"按当前列分组",showGroupsText:"显示分组"}],viewConfig:{loadingText:"<b>正在加载数据...</b>"},initComponent:function(){var me=this;me.on({itemclick:function(grid,record,hitem,index,e,opts){if(!e.ctrlKey&&!e.shiftKey){var sm=grid.getSelectionModel();sm.deselectAll(!0),sm.select(record,!0,!1)}},beforeitemmousedown:function(view,record,item,index,e,options){if(2==e.button){var sm=view.getSelectionModel();if(sm.hasSelection()){var sels=sm.getSelection();Ext.Array.contains(sels,record)||(sm.deselectAll(!0),sm.select(record,!0,!1))}else sm.select(record,!0,!1);return!1}return!0}}),me.callParent(arguments)}});
//# sourceMappingURL=BaseGrid.js.map
Ext.define("chl.tree.BaseTree",{alias:"widget.BaseTree",extend:"Ext.tree.Panel",clearOnLoad:!1,alternateClassName:["BaseTree"],ddGroup:"FileDDGp",animate:!1,rootVisible:!1,frame:!1,frameHeader:!1,border:!1,initComponent:function(){var me=this;me.on({load:function(store,records,models,suc,opts){!models||models.length<=0||Ext.Array.each(models,function(item,index,alls){var interStr=GlobalFun.treeInternational(item.data.id);""!=interStr?item.data.text=interStr:item.data.text=GlobalFun.owerInternational(item.data.text)})},render:function(){}}),me.callParent(arguments)}});
//# sourceMappingURL=BaseTree.js.map
Ext.define("chl.toolbar.Pagingtoolbar",{alias:"widget.Pagingtoolbar",extend:"Ext.toolbar.Paging",dock:"bottom",displayInfo:!0,emptyMsg:"没有记录",beforePageText:"页数",afterPageText:"共 {0}",refreshText:"刷新当前页",firstText:"首页",lastText:"末页",nextText:"下页",prevText:"前页",layout:{overflowHandler:"Menu"},initComponent:function(){var me=this;me.callParent(arguments),me.on("render",function(){me.down("#refresh").hide()})}});
//# sourceMappingURL=Pagingtoolbar.js.map
Ext.define("WS.action.Base",{extend:"Ext.Action",alternateClassName:["ActionBase"],config:{targetView:null,category:""},getTargetView:function(){var me=this;return me.tgtView?"function"==typeof me.tgtView?me.tgtView():me.tgtView:null},setTargetView:function(tgtView){var me=this;me.tgtView=tgtView},statics:{actions:[],setTargetView:function(category,view){Ext.Array.each(ActionBase.actions,function(act,index){return act.category==category&&act.setTargetView(view),!0})},setWidth:function(category,width){Ext.Array.each(ActionBase.actions,function(act,index){return act.category==category&&act.setWidth(width),!0})},updateActions:function(category){var prms=arguments;Ext.Array.each(ActionBase.actions,function(act,index){return act.category==category&&act.updateStatus&&act.updateStatus(prms[1],prms[2],prms[3],prms[4],prms[5],prms[6]),!0})},getAction:function(itemId){var res;return Ext.Array.each(ActionBase.actions,function(act,index){return act.itemId==itemId?(res=act,!1):!0}),res}},setChecked:function(v){this.callEach("setChecked",[v])},setWidth:function(v){this.callEach("setWidth",[v])},constructor:function(config){config.scope=this,this.callParent([config]),config.updateStatus&&(this.updateStatus=config.updateStatus),WS.action.Base.actions.push(this)}});
//# sourceMappingURL=Base.js.map
Ext.define("WS.lib.WsCall",{alternateClassName:["WsCall"]});var constErrRes={success:!1,code:-1,msg:"response failed"};WsCall.addStatics({call:function(url,fname,param,successCall,failureCall,showLoadMask,loadMsg,maskEl,maskDelay,async){param.req="call",param.callname=fname;var isAsync=0==async?async:!0,doslm="undefined"==typeof showLoadMask||null===showLoadMask||1==showLoadMask;if(doslm){var callMask,taskWait=new Ext.util.DelayedTask(function(){loadMsg?(callMask=maskEl?maskEl:Ext.getBody(),callMask.mask(loadMsg)):(callMask=maskEl?maskEl:Ext.getBody(),callMask.mask("请稍候..."))});taskWait.delay(maskDelay?maskDelay:100)}Ext.Ajax.request({url:url,method:"GET",timeout:3e4,async:isAsync,success:function(response,opts){if(taskWait&&taskWait.cancel(),"undefined"!=typeof callMask&&null!==callMask&&callMask.unmask(),response.responseText.length>0&&"null"!=response.responseText){var res=Ext.JSON.decode(response.responseText);1==res.success?successCall(res,response,opts):failureCall(res,response,opts)}else constErrRes.msg="response failed (call:"+fname+");"+response.responseText,failureCall(constErrRes,response,opts)},failure:function(response,opts){taskWait&&taskWait.cancel(),"undefined"!=typeof callMask&&null!==callMask&&callMask.unmask(),constErrRes.msg="response failed(ajax) (call:"+fname+")",failureCall(constErrRes,response,opts)},headers:{AJaxCall:"true"},params:param})},pcall:function(url,fname,param,successCall,failureCall,showLoadMask,loadMsg,maskEl,maskDelay,async){param.req="call",param.callname=fname;var isAsync=0==async?async:!0,doslm="undefined"==typeof showLoadMask||null===showLoadMask||1==showLoadMask;if(doslm){var callMask,taskWait=new Ext.util.DelayedTask(function(){loadMsg?(callMask=maskEl?maskEl:Ext.getBody(),callMask.mask(loadMsg)):(callMask=maskEl?maskEl:Ext.getBody(),callMask.mask("请稍候..."))});taskWait.delay(maskDelay?maskDelay:100)}Ext.Ajax.request({url:url,method:"POST",timeout:3e4,async:isAsync,success:function(response,opts){if(taskWait&&taskWait.cancel(),"undefined"!=typeof callMask&&null!==callMask&&callMask.unmask(),response.responseText.length>0&&"null"!=response.responseText){var res=Ext.JSON.decode(response.responseText);1==res.success?successCall(res,response,opts):failureCall(res,response,opts)}else constErrRes.msg="response failed (call:"+fname+");"+response.responseText,failureCall(constErrRes,response,opts)},failure:function(response,opts){taskWait&&taskWait.cancel(),"undefined"!=typeof callMask&&null!==callMask&&callMask.unmask(),constErrRes.msg="response failed(ajax) (call:"+fname+")",failureCall(constErrRes,response,opts)},headers:{AJaxCall:"true"},params:param})},downloadFile:function(url,rcName,param){var me=this,sParam=Ext.Object.toQueryString(param);sParam.length>0&&(sParam="&"+sParam);var url=url+"?req=rc&rcname="+rcName+sParam;if("undefined"==typeof me.iframe){var iframe=document.createElement("iframe");me.iframe=iframe,document.body.appendChild(me.iframe)}me.iframe.src=url,me.iframe.style.display="none"},callchain:function(callname){var host=window.location.host,name=userInfoData.accountName,iframe=document.getElementById("callchain");iframe&&document.body.removeChild(iframe),iframe=document.createElement("script"),iframe.id="callchain",iframe.attachEvent?iframe.onreadystatechange=function(){"loaded"==this.readyState}:(iframe.onload=function(){},iframe.onerror=function(){});var ranid=Ext.id()+(new Date).getTime();iframe.src="http://"+localPt.ip+":"+localPt.port+"/ifram.html?call="+callname+"&hosturl="+host+"&sessiontoken="+sessionToken+"&username="+name+"&ranid="+ranid+"@",document.body.appendChild(iframe)},scoutlogin:function(callname,fileid,callback){var href=window.location.href,name=userInfoData.accountName,iframe=document.getElementById("scoutlogin");iframe&&document.body.removeChild(iframe),iframe=document.createElement("script"),iframe.id="scoutlogin",iframe.attachEvent?iframe.onreadystatechange=function(){"loaded"==this.readyState&&callback&&(new Ext.util.DelayedTask).delay(50,function(){callback()})}:(iframe.onload=function(){callback&&(new Ext.util.DelayedTask).delay(500,function(){callback()})},iframe.onerror=function(){callback&&(new Ext.util.DelayedTask).delay(500,function(){callback()})});var fid="";fileid&&(fid=fileid);var ranid=Ext.id()+(new Date).getTime();iframe.src="http://"+scoutLogin.ip+":"+scoutLogin.port+"/ifram1.html?call="+callname+"&fileid="+fid+"&hrefurl="+href+"&sessiontoken="+sessionToken+"&username="+name+"&ranid="+ranid+"@",document.body.appendChild(iframe)},callOtherDomain:function(absPath,fileId,winType){var iframe=(encodeURI(absPath),document.getElementById("otherDomain"));iframe&&document.body.removeChild(iframe);var fid=fileId,param={};param.sessiontoken=sessionToken,WsCall.call("getjsessionid",param,function(response,opts){function afterifload(){var param={};param.sessiontoken=sessionToken,WsCall.call("getiframemsg",param,function(response,opts){Ext.getBody().unmask();var data=response.data;iframeFileUp(data,winType)},function(response,opts){var fpa=winType.down("#filePath");fpa&&fpa.reset(),Ext.getBody().unmask(),1862271269!=response.code&&(errorProcess(response.code)||Ext.Msg.alert("失败",response.msg))},!1)}var jsid=response.data;Ext.getBody().mask("正在使用本地打印机,请稍候..."),iframe=document.createElement("script"),iframe.id="otherDomain",iframe.attachEvent?iframe.onreadystatechange=function(){"loaded"==this.readyState&&afterifload()}:(iframe.onload=function(){afterifload()},iframe.onerror=function(){afterifload()});var host=window.location.host,ranid=Ext.id()+(new Date).getTime(),isdoc=!1;"docwin"==winType.pngGroup&&(isdoc=!0),iframe.src="http://"+localPt.ip+":"+localPt.port+"/ifram.html?call=file&localurl="+host+"&isdoc="+isdoc+"&pttype="+userConfig.prType+"&sessiontoken="+sessionToken+"&jsid="+jsid+"&fileid="+fid+"&ranid="+ranid+"@",document.body.appendChild(iframe)},function(response,opts){errorProcess(response.code)||Ext.Msg.alert("失败",response.msg)},!0,"",Ext.getBody(),10)}}),Ext.define("html5uploadclass",{config:{xhr:null,fisrtLoad:!0,file:null,formName:"",files:null,msgidArr:[],index:1,length:0,url:"",html5UploadInint:function(files,url,formName,eventFuns){var me=this;1==me.index&&(me.length=files.length),me.files=files,me.file=files[me.index-1],me.formName=formName,me.xhr=new XMLHttpRequest,eventFuns&&(me.xhr.upload.addEventListener("progress",eventFuns.uploadProgress,!1),me.xhr.addEventListener("load",eventFuns.uploadComplete,!1),me.xhr.addEventListener("error",eventFuns.uploadFailed,!1),me.xhr.addEventListener("abort",eventFuns.uploadCanceled,!1)),me.url=url},uploadStart:function(){var me=this,fd=new FormData;fd.append(me.formName,me.file),me.xhr.open("POST",me.url),me.xhr.send(fd)}},constructor:function(cfg){this.initConfig(cfg),this.xhr=null,this.fisrtLoad=!0,this.file=null,this.files=null,this.msgidArr=[],this.index=1,this.length=0,this.url=""}});
//# sourceMappingURL=WsCall_base.js.map
Ext.define("WS.lib.SearchField",{extend:"Ext.form.field.Trigger",alias:"widget.searchfield",trigger1Cls:Ext.baseCSSPrefix+"form-clear-trigger",trigger2Cls:Ext.baseCSSPrefix+"form-search-trigger",hasSearch:!1,paramName:"FullName",paramObject:!1,paramNameArr:[],initComponent:function(){var me=this;me.callParent(arguments),me.on("specialkey",function(f,e){e.getKey()==e.ENTER&&this.onTrigger2Click()},me)},boxready:function(){var me=this;me.callParent(),me.triggerEl.item(0).up("td").setWidth(0),me.triggerEl.item(0).setDisplayed("none")},onTrigger1Click:function(){var me=this,store=me.store,proxy=store.getProxy();me.hasSearch&&(me.setValue(""),proxy.extraParams.filter=Ext.JSON.decode(proxy.extraParams.filter),me.paramObject?Ext.Array.each(me.paramNameArr,function(key){delete proxy.extraParams.filter[key],store.filterMap.removeAtKey(key)}):(delete proxy.extraParams.filter[me.paramName],store.filterMap.removeAtKey(me.paramName)),proxy.extraParams.filter=Ext.JSON.encode(proxy.extraParams.filter),proxy.extraParams.start=0,proxy.extraParams.refresh=1,store.load(),proxy.extraParams.refresh=null,me.hasSearch=!1,me.triggerEl.item(0).up("td").setWidth(0),me.triggerEl.item(0).setDisplayed("none"),me.doComponentLayout())},onTrigger2Click:function(){var me=this,store=me.store,proxy=store.getProxy(),value=me.getValue();return value.length<1?void me.onTrigger1Click():(me.isValid()&&(proxy.extraParams.filter=Ext.JSON.decode(proxy.extraParams.filter),me.paramObject?Ext.Array.each(me.paramNameArr,function(key){var tempObj={};tempObj[me.paramName]=value,proxy.extraParams.filter[key]=tempObj,store.filterMap.containsKey(key)?store.filterMap.replace(key,tempObj):store.filterMap.add(key,tempObj)}):(proxy.extraParams.filter[me.paramName]=value,store.filterMap.containsKey(me.paramName)?store.filterMap.replace(me.paramName,value):store.filterMap.add(me.paramName,value)),proxy.extraParams.filter=Ext.JSON.encode(proxy.extraParams.filter),proxy.extraParams.start=0,proxy.extraParams.refresh=1,store.load(),proxy.extraParams.refresh=null),me.hasSearch=!0,me.triggerEl.item(0).up("td").setWidth(17),me.triggerEl.item(0).setDisplayed("block"),void me.doComponentLayout())}});
//# sourceMappingURL=SearchField.js.map
Ext.define("Ext.ux.form.field.DateTime",{extend:"Ext.form.FieldContainer",mixins:{field:"Ext.form.field.Field"},alias:"widget.datetimefield",layout:"hbox",width:200,height:22,combineErrors:!0,mySqlType:"time",tmpcId:"",doSearch:!1,dateCfg:{},timeHCfg:{},timeMCfg:{},timeICfg:{},initComponent:function(){var me=this;me.buildField(),me.callParent(),this.dateField=this.down("datefield"),this.timeHField=this.down("#sendTimeHouer"+this.tmpcId),this.timeMField=this.down("#sendTimeMin"+this.tmpcId),this.timeIField=this.down("#sendTimeSec"+this.tmpcId),me.initField()},buildField:function(){var me=this;if(me.items=[],("date"==me.mySqlType||"datetime"==me.mySqlType)&&me.items.push(Ext.apply({xtype:"datefield",itemId:"sendDate"+me.tmpcId,name:"sendDate"+me.tmpcId,format:"Y-m-d",width:90,submitValue:!1,blankText:"日期不能为空",allowBlank:!1},me.dateCfg)),("time"==me.mySqlType||"datetime"==me.mySqlType)&&me.items.push(Ext.apply({itemId:"sendTimeHouer"+me.tmpcId,name:"sendTimeHouer"+me.tmpcId,xtype:"numberfield",maxText:"时最大为23",minText:"时最小为0",submitValue:!1,allowDecimals:!1,width:40,minValue:0,maxValue:23,blankText:"不能为空",allowBlank:!1},me.timeHCfg),Ext.apply({itemId:"sendTimeMin"+me.tmpcId,name:"sendTimeMin"+me.tmpcId,xtype:"numberfield",maxText:"分最大为59",minText:"分最小为0",submitValue:!1,allowDecimals:!1,width:40,minValue:0,maxValue:59,blankText:"不能为空",allowBlank:!1},me.timeMCfg),Ext.apply({itemId:"sendTimeSec"+me.tmpcId,name:"sendTimeSec"+me.tmpcId,xtype:"numberfield",maxText:"秒最大为59",minText:"秒最小为0",submitValue:!1,allowDecimals:!1,width:40,minValue:0,maxValue:59,blankText:"不能为空",allowBlank:!1},me.timeICfg)),me.doSearch){var serTmp=Ext.clone(me.items);"date"==me.mySqlType?me.items.push({margin:"0 0 0 5",xtype:"displayfield",width:20,value:"--"}):me.items.push({margin:"0 0 0 5",xtype:"displayfield",width:20,value:"--"}),Ext.Array.each(serTmp,function(item,index,alls){("numberfield"==item.xtype||"datefield"==item.xtype)&&(item.name="end_"+item.name,item.itemId="end_"+item.itemId),"hidden"==item.xtype&&(item.name="end_"+item.name,item.myXtype="end_"+item.myXtype,item.itemId="end_"+item.itemId,item.submitValue=!1),me.items.push(item)})}},getValue:function(){var me=this,strTime="";if("date"==me.mySqlType){var strTime=Ext.util.Format.date(me.down("#sendDate"+me.tmpcId).getValue(),"Y-m-d");if(me.doSearch){var endTime=Ext.util.Format.date(me.down("#end_sendDate"+me.tmpcId).getValue(),"Y-m-d");strTime+=","+endTime}return strTime}if("datetime"==me.mySqlType){var strTime=Ext.util.Format.date(me.down("#sendDate"+me.tmpcId).getValue(),"Y-m-d"),tmpH=me.down("#sendTimeHouer"+me.tmpcId).getValue();tmpH=10>tmpH?"0"+tmpH:tmpH;var tmpM=me.down("#sendTimeMin"+me.tmpcId).getValue();tmpM=10>tmpM?"0"+tmpM:tmpM;var tmpS=me.down("#sendTimeSec"+me.tmpcId).getValue();if(tmpS=10>tmpS?"0"+tmpS:tmpS,strTime+=" "+tmpH+":"+tmpM+":"+tmpS,me.doSearch){var endTime=Ext.util.Format.date(me.down("#end_sendDate"+me.tmpcId).getValue(),"Y-m-d"),tmpH1=me.down("#end_sendTimeHouer"+me.tmpcId).getValue(),tmpM1=me.down("#end_sendTimeMin"+me.tmpcId).getValue(),tmpS1=me.down("#end_sendTimeSec"+me.tmpcId).getValue();tmpH1=10>tmpH1?"0"+tmpH1:tmpH1,tmpM1=10>tmpM1?"0"+tmpM1:tmpM1,tmpS1=10>tmpS1?"0"+tmpS1:tmpS1,endTime+=" "+tmpH1+":"+tmpM1+":"+tmpS1,strTime+=","+endTime}return strTime}if("time"==me.mySqlType){var tmpH=me.down("#sendTimeHouer"+me.tmpcId).getValue();tmpH=10>tmpH?"0"+tmpH:tmpH;var tmpM=me.down("#sendTimeMin"+me.tmpcId).getValue();tmpM=10>tmpM?"0"+tmpM:tmpM;var tmpS=me.down("#sendTimeSec"+me.tmpcId).getValue();tmpS=10>tmpS?"0"+tmpS:tmpS;var strTime=tmpH+":"+tmpM+":"+tmpS;if(me.doSearch){var tmpH1=me.down("#end_sendTimeHouer"+me.tmpcId).getValue(),tmpM1=me.down("#end_sendTimeMin"+me.tmpcId).getValue(),tmpS1=me.down("#end_sendTimeSec"+me.tmpcId).getValue();tmpH1=10>tmpH1?"0"+tmpH1:tmpH1,tmpM1=10>tmpM1?"0"+tmpM1:tmpM1,tmpS1=10>tmpS1?"0"+tmpS1:tmpS1;var endTime=tmpH1+":"+tmpM1+":"+tmpS1;strTime+=","+endTime}return strTime}return null},setValue:function(value,useval){var me=this;if(("date"==me.mySqlType||"datetime"==me.mySqlType)&&me.dateField.setValue(me.dateCfg.value?me.dateCfg.value:Ext.util.Format.date(new Date,"Y-m-d")),("time"==me.mySqlType||"datetime"==me.mySqlType)&&(me.timeHField.setValue(me.timeHCfg.value?me.timeHCfg.value:0),me.timeMField.setValue(me.timeMCfg.value?me.timeMCfg.value:0),me.timeIField.setValue(me.timeICfg.value?me.timeICfg.value:0),useval)){var date,timeH=value.split(":")[0],timeM=value.split(":")[1],timeI=value.split(":")[2];"datetime"==me.mySqlType&&(date=value.split("T")[0]),date&&(date=timeH.split("T")[0],timeH=timeH.split("T")[1],me.dateField.setValue(date)),me.timeHField.setValue(timeH),me.timeMField.setValue(timeM),me.timeIField.setValue(timeI)}},isFileUpload:function(){return"file"===this.inputType},getSubmitData:function(){var me=this,value=me.getValue(),name=me.name,data={};if(!me.disabled&&me.submitValue&&!me.isFileUpload()){if(value&&"datetime"==me.mySqlType){var re=/\s/g;value=value.replace(re,"T")}return data[""+name]=value,value&&name?data:null}},setFieldStyle:function(style){var me=this,inputEl=me.timeHField?me.timeHField.inputEl:null,inputEl1=me.timeMField?me.timeMField.inputEl:null,inputEl2=me.timeIField?me.timeIField.inputEl:null,inputEl3=me.dateField?me.dateField.inputEl:null;inputEl&&inputEl.applyStyles(style),inputEl1&&inputEl1.applyStyles(style),inputEl2&&inputEl2.applyStyles(style),inputEl3&&inputEl3.applyStyles(style),me.fieldStyle=style,me.timeHField.fieldStyle=style,me.timeMField.fieldStyle=style,me.timeMField.fieldStyle=style},setReadOnly:function(readOnly){var me=this,inputEl=me.timeHField?me.timeHField.inputEl:null,inputEl1=me.timeMField?me.timeMField.inputEl:null,inputEl2=me.timeIField?me.timeIField.inputEl:null,inputEl3=me.dateField?me.dateField.inputEl:null;readOnly=!!readOnly,me[readOnly?"addCls":"removeCls"](me.readOnlyCls),me.readOnly=readOnly,inputEl?(inputEl.dom.readOnly=readOnly,me.timeHField.setReadOnly(readOnly)):me.rendering&&(me.timeHField.setReadOnlyOnBoxReady=!0),inputEl1?(inputEl1.dom.readOnly=readOnly,me.timeMField.setReadOnly(readOnly)):me.rendering&&(me.timeMField.setReadOnlyOnBoxReady=!0),inputEl2?(inputEl2.dom.readOnly=readOnly,me.timeIField.setReadOnly(readOnly)):me.rendering&&(me.timeIField.setReadOnlyOnBoxReady=!0),inputEl3?(inputEl3.dom.readOnly=readOnly,me.dateField.setReadOnly(readOnly)):me.rendering&&(me.dateField.setReadOnlyOnBoxReady=!0),me.updateLayout(),me.fireEvent("writeablechange",me,readOnly)}});
//# sourceMappingURL=DateTimeField.js.map
Ext.define("Ext.ux.CheckColumn",{extend:"Ext.grid.column.Column",alias:"widget.checkcolumn",constructor:function(){this.addEvents(),this.callParent(arguments)},processEvent:function(type,view,cell,recordIndex,cellIndex,e){if("mousedown"==type||"keydown"==type&&(e.getKey()==e.ENTER||e.getKey()==e.SPACE)){var record=view.panel.store.getAt(recordIndex),dataIndex=this.dataIndex,checked=!record.get(dataIndex);return record.set(dataIndex,checked),record.commit(),this.fireEvent("checkchange",this,recordIndex,checked),!1}return this.callParent(arguments)},renderer:function(value){var cssPrefix=Ext.baseCSSPrefix,cls=[cssPrefix+"grid-checkheader"];return value&&cls.push(cssPrefix+"grid-checkheader-checked"),'<div class="'+cls.join(" ")+'">&#160;</div>'}});
//# sourceMappingURL=checkcol.js.map
function getContentByNType(ntype,data,bodyFields){var reStr="";if(0==ntype){reStr="你有一封新传真<br/>";for(var i=0;i<bodyFields.length;i++)"param2"!=bodyFields[i]?"param3"==bodyFields[i]&&(reStr+="传真位置:"+owerInternational(data[bodyFields[i]])):reStr+="发件人:"+data[bodyFields[i]]+"<br/>";return reStr}if(1==ntype)return reStr;if(2==ntype){reStr="你有一条新短信<br/>";for(var i=0;i<bodyFields.length;i++)"param2"!=bodyFields[i]?"param3"==bodyFields[i]&&(reStr+="短信位置:"+owerInternational(data[bodyFields[i]])):reStr+="发件人:"+data[bodyFields[i]]+"<br/>";return reStr}if(3==ntype){reStr="传真发送成功<br/>";for(var i=0;i<bodyFields.length;i++)"param2"!=bodyFields[i]?"param3"==bodyFields[i]&&(reStr+="主题:"+data[bodyFields[i]]):reStr+="收件人:"+data[bodyFields[i]]+"<br/>";return reStr}if(4==ntype){reStr="传真发送失败<br/>";for(var i=0;i<bodyFields.length;i++)"param2"!=bodyFields[i]?"param3"==bodyFields[i]&&(reStr+="主题:"+data[bodyFields[i]]):reStr+="收件人:"+data[bodyFields[i]]+"<br/>";return reStr}if(5==ntype){reStr="短信发送成功<br/>";for(var i=0;i<bodyFields.length;i++)if("param2"!=bodyFields[i])"param3"==bodyFields[i]&&(reStr+="主题:"+data[bodyFields[i]]);else{var myparam2=data[bodyFields[i]];-1==myparam2.indexOf("#")?reStr+="短信条数:"+myparam2+"<br/>":(myparam2=myparam2.substring(1,myparam2.length),reStr+="收件人:"+myparam2+"<br/>")}return reStr}if(6==ntype){reStr="短信发送失败<br/>";for(var i=0;i<bodyFields.length;i++)if("param2"!=bodyFields[i])"param3"==bodyFields[i]&&(reStr+="主题:"+data[bodyFields[i]]);else{var myparam2=data[bodyFields[i]];-1==myparam2.indexOf("#")?reStr+="短信条数:"+myparam2+"<br/>":(myparam2=myparam2.substring(1,myparam2.length),reStr+="收件人:"+myparam2+"<br/>")}return reStr}if(7==ntype){reStr="有新文档等待你的审批<br/>";for(var i=0;i<bodyFields.length;i++)"param2"!=bodyFields[i]||(reStr+="提交人:"+data[bodyFields[i]]+"<br/>");return reStr}if(8==ntype){reStr="通过审批<br/>";for(var i=0;i<bodyFields.length;i++)"param2"!=bodyFields[i]?"param3"==bodyFields[i]&&(reStr+="结束时间:"+data[bodyFields[i]]):reStr+="任务ID:"+data[bodyFields[i]]+"<br/>";return reStr}if(9==ntype){reStr="未通过审批<br/>";for(var i=0;i<bodyFields.length;i++)"param2"!=bodyFields[i]?"param3"==bodyFields[i]&&(reStr+="结束时间:"+data[bodyFields[i]]):reStr+="任务ID:"+data[bodyFields[i]]+"<br/>";return reStr}if(10==ntype){for(var i=0;i<bodyFields.length;i++)"param2"!=bodyFields[i]||(reStr+=""+data[bodyFields[i]]+"<br/>");return reStr}if(11==ntype){for(var i=0;i<bodyFields.length;i++)if("param3"!=bodyFields[i]);else{var msgSt="";if(0!=data[bodyFields[i]]){var wrStr="";(1&data[bodyFields[i]])>0&&(wrStr+="接收传真,"),(64&data[bodyFields[i]])>0&&(wrStr+="工作流审批,"),(32&data[bodyFields[i]])>0&&(wrStr+="管理员,"),wrStr=wrStr.substring(0,wrStr.length-1),msgSt="赋予您的职责是:"+wrStr}else msgSt="已经收回委任给你的职责";reStr+=""+msgSt+"<br/>"}return reStr}}Ext.define("Ext.ux.PreviewPlugin",{extend:"Ext.AbstractPlugin",alias:"plugin.preview",requires:["Ext.grid.feature.RowBody","Ext.grid.feature.RowWrap"],hideBodyCls:"x-grid-row-body-hidden",bodyField:"",bodyFields:[],previewExpanded:!0,constructor:function(config){this.callParent(arguments);var bodyField=this.bodyField,bodyFields=this.bodyFields,hideBodyCls=this.hideBodyCls,section=this.getCmp(),features=[{ftype:"rowbody",getAdditionalData:function(data,idx,record,orig,view){var o=Ext.grid.feature.RowBody.prototype.getAdditionalData.apply(this,arguments),type=data[bodyField],rowBodyStr=getContentByNType(type,data,bodyFields);return Ext.apply(o,{rowBody:rowBodyStr,rowBodyCls:section.previewExpanded?"":hideBodyCls}),o}},{ftype:"rowwrap"}];section.previewExpanded=this.previewExpanded,section.features||(section.features=[]),section.features=features.concat(section.features)},toggleExpanded:function(expanded){var view=this.getCmp();this.previewExpanded=view.previewExpanded=expanded,view.refresh()}});
//# sourceMappingURL=GridPreviewPlugin.js.map
var mykeycodeConvert={32:" ",48:"0","48s":")",49:"1","49s":"!",50:"2","50s":"@",51:"3","51s":"#",52:"4","52s":"$",53:"5","53s":"%",54:"6","54s":"^",55:"7","55s":"&",56:"8","56s":"*",57:"9","57s":"(",65:"a","65s":"A",66:"b","66s":"B",67:"c","67s":"C",68:"d","68s":"D",69:"e","69s":"E",70:"f","70s":"F",71:"g","71s":"G",72:"h","72s":"H",73:"i","73s":"I",74:"j","74s":"J",75:"k","75s":"K",76:"l","76s":"L",77:"m","77s":"M",78:"n","78s":"N",79:"o","79s":"O",80:"p","80s":"P",81:"q","81s":"Q",82:"r","82s":"R",83:"s","83s":"S",84:"t","84s":"T",85:"u","85s":"U",86:"v","86s":"V",87:"w","87s":"W",88:"x","88s":"X",89:"y","89s":"Y",90:"z","90s":"Z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",186:";","186s":":",187:"=","187s":"+",188:",","188s":"<",189:"-","189s":"_",190:".","190s":">",191:"/","191s":"?",192:"`","192s":"~",219:"[","219s":"{",220:"\\","220s":"|",221:"]","221s":"}",222:"'","222s":'"'};Ext.define("Ext.ux.form.field.MyPasswordField",{extend:"Ext.form.field.Text",alias:"widget.MyPasswordField",keyCodeArr:[],replaceChar:"●",onKeyDown:function(e){var me=this,keycode=e.getKey();if(e.ctrlKey)keycode!=e.BACKSPACE&&(me.keyCodeArr=[]);else if(32==keycode||keycode>=65&&90>=keycode||keycode>=48&&57>=keycode||keycode>=96&&107>=keycode||keycode>=109&&111>=keycode||keycode>=186&&192>=keycode||keycode>=219&&222>=keycode||keycode==e.BACKSPACE){var selectedText;window.getSelection?selectedText=window.getSelection():document.selection&&(selectedText=document.selection.createRange().text);var length=selectedText.toString().length;if(keycode!=e.BACKSPACE)length&&length>0&&(me.keyCodeArr=[]),keycode>=65&&90>=keycode||keycode>=48&&57>=keycode||keycode>=186&&192>=keycode||keycode>=219&&222>=keycode?e.shiftKey?me.keyCodeArr.push(mykeycodeConvert[keycode+"s"]):me.keyCodeArr.push(mykeycodeConvert[keycode]):(32==keycode||keycode>=96&&107>=keycode||keycode>=109&&111>=keycode)&&me.keyCodeArr.push(mykeycodeConvert[keycode]);else if(length&&length>0)for(var i=0;length>i;i++)me.keyCodeArr.pop();else me.keyCodeArr.pop();for(var strVal="",i=0;i<me.keyCodeArr.length;i++)strVal+=me.replaceChar;me.setValue(strVal,!0),e.stopEvent()}this.fireEvent("keydown",this,e)},onKeyUp:function(e){this.fireEvent("keyup",this,e)},onKeyPress:function(e){this.fireEvent("keypress",this,e)},initComponent:function(){var me=this;me.keyCodeArr=[],me.callParent()},getValue:function(){for(var me=this,val=me.rawToValue(me.processRawValue(me.getRawValue())),strVal="",i=0;i<me.keyCodeArr.length;i++)strVal+=me.replaceChar;return me.value=strVal,val},rawToValue:function(rawValue){return rawValue},processRawValue:function(value){return value},getRawValue:function(){var me=this,v=me.keyCodeArr.join("");return me.rawValue=v,v},setRawValue:function(value){var me=this;return value=Ext.value(me.transformRawValue(value),""),me.rawValue=value,me.inputEl&&(me.inputEl.dom.value=value),value},transformRawValue:function(value){return value},valueToRaw:function(value){return""+Ext.value(value,"")},setValue:function(value,nopush){var me=this,myval=me.valueToRaw(value);if(!nopush){me.keyCodeArr=[];for(var i=0;i<myval.length;i++)me.keyCodeArr.push(myval.charAt(i))}for(var strVal="",i=0;i<me.keyCodeArr.length;i++)strVal+=me.replaceChar;return me.setRawValue(strVal),me.mixins.field.setValue.call(me,strVal)},onBoxReady:function(){var me=this;me.inputEl.dom.style.imeMode="disabled",me.inputEl.on("dblclick",function(){me.selectText()}),me.callParent()}});
//# sourceMappingURL=MyPasswordfield.js.map
Ext.define("Ext.ux.form.field.Html5FileUpload",{extend:"Ext.form.field.File",alias:"widget.Html5FileUpload",accept:"*/*",supType:["xls","xlsx"],style:"",uploadUrl:"",progressContainerEl:"",progressEl:"",countEl:"",currentFile:0,totalFile:0,fileNameLabelEl:"",multipleDataArr:[],onRender:function(){var inputEl,me=this;me.callParent(arguments),inputEl=me.inputEl,inputEl.dom.name="",me.createFileInput(),me.buttonOnly&&me.inputCell.setDisplayed(!1),me.browseButtonWrap.dom.style.width=me.browseButtonWrap.dom.lastChild.offsetWidth+me.buttonEl.getMargin("lr")+"px",Ext.isIE&&me.buttonEl.repaint()},sendFile:function(file,scope){var me=this,xhr=new XMLHttpRequest,fd=new FormData;scope.updatePropress(xhr,scope),xhr.open("POST",me.uploadUrl,!0),xhr.onreadystatechange=function(){4==xhr.readyState&&200==xhr.status},fd.append("fileUpload",file),xhr.send(fd)},FileUpload:function(file,scope){var xhr=new XMLHttpRequest,fd=new FormData,xhr=new XMLHttpRequest;scope.updatePropress(xhr,scope),xhr.open("POST",scope.uploadUrl,!0),xhr.onreadystatechange=function(){4==xhr.readyState&&200==xhr.status&&(console.log(xhr.responseText),scope.multipleDataArr.push(file.name))},fd.append("fileUpload",file),xhr.send(fd)},sendFiles:function(files){var me=this;me.progressEl.dom.value=0,me.countEl.dom.innerHTML="文件: 1/"+files.length,me.totalFile=Ext.clone(files.length);for(var str="",i=0;i<files.length;i++)str+=files[i].name+";";me.fileNameLabelEl.dom.innerHTML=str;for(var i=0;i<files.length;i++)new me.FileUpload(files[i],me)},updatePropress:function(xhr,scope){this.xhr=xhr,this.xhr.upload.addEventListener("progress",function(e){if(e.lengthComputable){var percentage=Math.round(100*e.loaded/e.total);scope.progressEl.dom.value=percentage}},!1),xhr.upload.addEventListener("load",function(e){scope.progressEl.dom.value=100,scope.currentFile++,scope.countEl.dom.innerHTML="文件: "+scope.currentFile+"/"+scope.totalFile,scope.currentFile==scope.totalFile&&(scope.currentFile=0,scope.totalFile=0,ActionManager.showUpLoadExcelError(scope.multipleDataArr),scope.multipleDataArr=[])},!1)},createFileInput:function(){var me=this;me.fileInputEl=me.buttonEl.createChild({name:me.getName(),id:me.id+"-fileInputEl",cls:Ext.baseCSSPrefix+"form-file-input",tag:"input",type:"file",size:1,accept:me.accept,multiple:"multiple",style:""}),me.fileInputEl.on({scope:me,change:me.onFileChange});var dropzone=me.el.dom;dropzone.ondragover=dropzone.ondragenter=function(event){event.stopPropagation(),event.preventDefault()},dropzone.ondrop=function(event){if(event.stopPropagation(),event.preventDefault(),Ext.isIE)return void Ext.Msg.alert("消息","您的浏览器不支持Html5上传,请更换浏览器或升级版本。");for(var returnFlag=(me.supType,!0),files=event.dataTransfer.files,str="",i=0;i<files.length;i++){str+=files[i].name+";";var fNmae=files[i].name,fType=fNmae.substring(fNmae.lastIndexOf(".")+1,fNmae.length).toLowerCase();Ext.Array.each(me.supType,function(rec){return rec==fType?(returnFlag=!1,!1):void 0})}if(returnFlag)return void Ext.Msg.alert("添加文件","不支持的文件格式！");me.progressEl.dom.value=0,me.countEl.dom.innerHTML="文件: 1/"+files.length,me.totalFile=Ext.clone(files.length),me.fileNameLabelEl.dom.innerHTML=str;for(var i=0;i<files.length;i++)me.sendFile(files[i],me)},me.fileNameLabelEl=me.triggerWrap.up("#"+me.id).createChild({name:me.getName(),style:"width:"+me.getWidth()+"px;padding:5px 5px 5px 5px;",id:me.id+"-fileInputFileNameLabelEl",cls:Ext.baseCSSPrefix+"form-file-input-fileNameLabel",tag:"div"}),me.progressContainerEl=me.triggerWrap.up("#"+me.id).createChild({name:me.getName(),style:"width:"+me.getWidth()+"px;padding:5px 5px 5px 5px;",id:me.id+"-fileInputProgressContainerEl",cls:Ext.baseCSSPrefix+"form-file-input-progressContainer",tag:"div"}),me.progressEl=me.progressContainerEl.createChild({name:me.getName(),style:"width:"+(me.getWidth()-120)+"px;",value:0,max:100,id:me.id+"-fileInputProgressEl",cls:Ext.baseCSSPrefix+"form-file-input-progress",tag:"progress"}),me.countEl=me.progressContainerEl.createChild({name:me.getName(),style:"width:100px;margin-left:5px;",id:me.id+"-fileInputCountEl",cls:Ext.baseCSSPrefix+"form-file-input-count",tag:"label"}),me.countEl.dom.innerHTML="文件: 0/0"}});
//# sourceMappingURL=html5FileUpload.js.map
myStates={infaxgridState:{},infaxgridFilter:{},outfaxgridState:{},outfaxgridFilter:{},succoutfaxgridState:{},succoutfaxgridFilter:{},draftgridState:{},addressgridState:{},docgridState:{},docgridFilter:{},taskgridState:{},taskgridFilter:{},wfrulegridState:{},smsinfaxgridState:{},smsinfaxgridFilter:{},smsoutfaxgridState:{},smsoutfaxgridFilter:{},westPanelState:{},centerPanelState:{},centerCenterPanelState:{},centerSouthPanelState:{},southPanelState:{},printerSrc:{},printerType:{},faxtoolBtn:{},currtree:{},searchState:{},smscbState:{}};var setSerStates=new Ext.util.DelayedTask,stateSorArr=["infaxgridState","infaxgridFilter","outfaxgridState","outfaxgridFilter","succoutfaxgridState","succoutfaxgridFilter","draftgridState","addressgridState","docgridState","docgridFilter","taskgridState","taskgridFilter","wfrulegridState","smsinfaxgridState","smsinfaxgridFilter","smsoutfaxgridState","smsoutfaxgridFilter","westPanelState","centerPanelState","centerCenterPanelState","centerSouthPanelState","southPanelState","printerSrc","printerType","faxtoolBtn","currtree","searchState","smscbState"];Ext.define("WS.lib.MyStateProvider",{extend:"Ext.state.Provider",constructor:function(config){var me=this;config=config||{},Ext.isDefined(config.sessiontoken)&&(me.sessiontoken=config.sessiontoken),me.callParent(arguments),me.state=me.readMyStates()},set:function(name,value){var me=this;return"undefined"==typeof value||null===value?void me.clear(name):(me.setServerState(name,value),void me.callParent(arguments))},clear:function(name){this.clearServerState(name),this.callParent(arguments)},readMyStates:function(){var states=myStates,param={};return param.sessiontoken=GlobalFun.getSeesionToken(),param.key=Ext.JSON.encode(stateSorArr),WsCall.call("readmystates",param,function(response,opts){var datas=Ext.JSON.decode(response.data);Ext.Array.each(datas,function(val,index,alls){var tmpKey=stateSorArr[index];val.stateSaved=!0,myStates[tmpKey]=val})},function(response,opts){},!1,null,null,null,!1),states},setServerState:function(name,value){value.stateSaved=!1;for(key in stateSorArr){var ssArr=stateSorArr[key];if(ssArr==name){var curState=myStates[ssArr],tmpAr=[];curState&&value.columns&&curState.columns&&(Ext.Array.each(value.columns,function(item){var hasP=!1;Ext.Array.each(curState.columns,function(it){it.id==item.id&&(item.HasV=!0,hasP=!0,it=Ext.Object.merge(it,item))}),hasP&&tmpAr.push(item)}),Ext.Array.each(value.columns,function(it){it.HasV||tmpAr.push(it)}),curState.columns=tmpAr,value.columns=curState.columns),curState=value,setSerStates.cancel(),setSerStates.delay(6e3,function(){for(key1 in stateSorArr){var tmp=myStates[stateSorArr[key1]];if(tmp&&!tmp.stateSaved){var tmpStr=Ext.JSON.encode(tmp);if("{}"!=tmpStr){var param={};param.sessiontoken=GlobalFun.getSeesionToken(),param.key=stateSorArr[key1],param.value=tmpStr,tmp.stateSaved=!0,WsCall.call("setmystates",param,function(response,opts){},function(response,opts){},!1)}}}});break}}},clearServerState:function(name){}});
//# sourceMappingURL=MyStateProvider.js.map
Ext.define("chl.exUnit.GridFilterMenuButton",{alias:"widget.GridFilterMenuButton",extend:"Ext.button.Button",filterParam:!1,menu:{defaults:{xtype:"menucheckitem"},items:[]},initComponent:function(){var me=this;me.callParent(arguments),me.on("boxready",function(componet,width,height,eOpts){if(me.filterParam){var target=componet.up(me.filterParam.GridTypeName);GridManager.CreateGridFilterMenu(componet,me.filterParam.store,{group:me.filterParam.group,text:me.filterParam.text,target:target,componet:componet,filterKey:me.filterParam.filterKey})}})}}),Ext.define("chl.exUnit.GridSelectCancelMenuButton",{alias:"widget.GridSelectCancelMenuButton",extend:"Ext.button.Button",targetName:!1,menu:{defaults:{xtype:"menuitem"},items:[]},initComponent:function(){var me=this;me.callParent(arguments),me.on("boxready",function(componet,width,height,eOpts){var target=componet.up(me.targetName);GridManager.CreateGridSelectCancelMenu(componet,target)})}}),Ext.define("chl.exUnit.MiniPngDDSortPanel",{alias:"widget.MiniPngDDSortPanel",extend:"Ext.container.Container",alternateClassName:["MiniPngDDSortPanel"],itemId:"MiniPngDDSortPanel",frame:!1,layout:{type:"auto",width:100},bodyStyle:{background:"#DFE8F6"},autoScroll:!0,defaults:{xtype:"image",width:100,height:100,margin:"5 5 5 5",style:{"float":"left"}},items:[]}),Ext.define("MiniPngDDSortViewClass",{config:{selectAll:0,pngSels:new Ext.util.MixedCollection,pngAllMini:new Ext.util.MixedCollection,RowId:0,AreaId:0,currPngTotal:1,shiftImg:0},constructor:function(cfg){this.initConfig(cfg),this.pngSels=new Ext.util.MixedCollection,this.pngSelBig=new Ext.util.MixedCollection,this.pngAllMini=new Ext.util.MixedCollection},initPngPanel:function(palPngContainer){var window=palPngContainer.up("window"),pngClass=window.pngClass,pngNStyle={border:"1px solid black","background-color":"#FFFFFF","background-image":"none","background-repeat":"no-repeat"},param={limit:0,page:0,filter:"{ AreaId: "+pngClass.AreaId+",RowId:"+pngClass.RowId+" }",dir:"ASC",sort:"SortNum",sessiontoken:GlobalFun.getSeesionToken()};WsCall.call(GlobalConfig.Controllers.TombstoneGrid.read,"LoadTombstoneGrid",param,function(response,opts){var data=response.dataset;window.el.mask("请稍候..."),Ext.Array.each(data,function(item,index,allItems){var src=GlobalFun.GetTomestoneImageSrc(item.PaymentStatusId,item.Id,item.TypeId),pngContainer=Ext.create("Ext.container.Container",{width:100,height:80,tombstoneId:item.Id,layout:{type:"vbox",align:"center"},items:[{xtype:"image",cls:"hospital-target",sortNum:index,tombstoneId:item.Id,width:77,height:60,style:pngNStyle,src:src,listeners:{boxready:function(img,width,height,opts){DropDragControl.initializeHospitalDropZone(img,window);var imgDom=img.getEl();pngClass.getPngAllMini().add(img.id,img),imgDom.on("click",function(eve){if(!stopClick){if(eve.ctrlKey){pngClass.setShiftImg(img);var borderStyle=imgDom.getStyle("border",!0);return void("1px solid black"==borderStyle||"black 1px solid"==borderStyle?(imgDom.setStyle("border","3px solid blue"),pngClass.getPngSels().contains(img)||(DropDragControl.uninitHospitalDropZone(img),DropDragControl.initializePatientDragZone(img,window),pngClass.getPngSels().add(img.id,img))):(imgDom.setStyle("border","1px solid black"),pngClass.getPngSels().contains(img)&&(DropDragControl.uninitPatientDragZone(img),DropDragControl.initializeHospitalDropZone(img,window),pngClass.getPngSels().remove(img))))}if(eve.shiftKey){var firstImg,imageList=palPngContainer.query("image");return Ext.Array.each(imageList,function(item,index,allItems){0==index&&(firstImg=0!=pngClass.getShiftImg()?pngClass.getShiftImg():item),DropDragControl.uninitPatientDragZone(item),DropDragControl.initializeHospitalDropZone(item,window)}),pngClass.getPngSels().clear(),void Ext.Array.each(imageList,function(item,index,allItems){var imgItem=item.getEl();imgItem.setStyle("border","1px solid black"),item.sortNum>=firstImg.sortNum&&item.sortNum<=img.sortNum&&!item.ownerCt.disabled&&(imgItem.setStyle("border","3px solid blue"),DropDragControl.uninitHospitalDropZone(item),DropDragControl.initializePatientDragZone(item,window),pngClass.getPngSels().add(item.id,item)),item.sortNum<=firstImg.sortNum&&item.sortNum>=img.sortNum&&!item.ownerCt.disabled&&(imgItem.setStyle("border","3px solid blue"),DropDragControl.uninitHospitalDropZone(item),DropDragControl.initializePatientDragZone(item,window),pngClass.getPngSels().add(item.id,item))})}pngClass.setShiftImg(img);var imageList=palPngContainer.query("image");Ext.Array.each(imageList,function(item,index,allItems){DropDragControl.uninitPatientDragZone(item),DropDragControl.initializeHospitalDropZone(item,window)}),pngClass.getPngSels().clear(),Ext.Array.each(imageList,function(item,index,allItems){var imgItem=item.getEl();imgItem.setStyle("border","1px solid black"),item.id==img.id&&(imgItem.setStyle("border","3px solid blue"),DropDragControl.uninitHospitalDropZone(item),DropDragControl.initializePatientDragZone(item,window),pngClass.getPngSels().add(item.id,item))})}}),imgDom.on("dblclick",function(){var imageList=palPngContainer.query("image");Ext.Array.each(imageList,function(item,index,allItems){DropDragControl.uninitPatientDragZone(item),DropDragControl.initializeHospitalDropZone(item,window)}),pngClass.getPngSels().clear(),Ext.Array.each(imageList,function(item,index,allItems){var imgItem=item.getEl();imgItem.setStyle("border","1px solid black")});var borderStyle=imgDom.dom.style.border;("1px solid black"==borderStyle||"black 1px solid"==borderStyle)&&(imgDom.setStyle("border","3px solid blue"),pngClass.getPngSels().contains(img)||(DropDragControl.uninitHospitalDropZone(img),DropDragControl.initializePatientDragZone(img,window),pngClass.getPngSels().add(img.id,img)))}),imgDom.dom.onload=function(){imgDom.dom&&imgDom.dom.height>1&&img.ownerCt.el.unmask()}}}},{xtype:"label",text:item.Alias}]});palPngContainer.add(pngContainer)}),window.el.unmask()},function(response,opts){GlobalFun.errorProcess(response.code)||Ext.Msg.alert("失败",response.msg)},!0,"请稍候...",palPngContainer.el)}}),Ext.define("chl.exUnit.AreaTombstoneImagePanel",{alias:"widget.AreaTombstoneImagePanel",extend:"Ext.panel.Panel",alternateClassName:["AreaTombstoneImagePanel"],itemId:"AreaTombstoneImagePanel",frame:!1,bodyStyle:{background:"#DFE8F6"},border:!1,autoScroll:!0,style:{"overflow-x":"auto","white-space":"nowrap"},dockedItems:[{xtype:"container",itemId:"container",layout:{type:"hbox",align:"middle"},height:34,dock:"top",defaults:{margin:"2px 2px 2px 2px"},items:[{xtype:"textfield",itemId:"tombCode",cls:"big-fieldtext",fieldLabel:"区域或墓碑编码",labelWidth:100,labelAlign:"right",allowBlank:!1,blankText:"不能为空",regex:GlobalConfig.RegexController.regexTombstoneCode,regexText:"请输入3位或5位或7位编码",enableKeyEvents:!0,listeners:{keypress:function(field,e,opts){if(e.getKey()==e.ENTER){var toolbar=field.up("container"),showTomb=toolbar.down("#showTomb");showTomb.fireEvent("click",showTomb)}if(e.getKey()==e.ESC){var toolbar=field.up("container"),reset=toolbar.down("#reset");reset.fireEvent("click",reset)}}}},{xtype:"button",text:"选择",handler:function(com){var w=this.up("container"),field=w.down("#tombCode");WindowManager.SelectCemeteryAreaWin=WindowManager.ShowSelectCemeteryAreaWin(),WindowManager.SelectCemeteryAreaWin.callComponent=field}},{text:"显示",xtype:"button",iconCls:"search",width:100,cls:"big-fieldtext",itemId:"showTomb",listeners:{click:function(com){var toolbar=com.up("container"),tombCode=toolbar.down("#tombCode");if(tombCode.isValid()){GridManager.AreaTombstoneImagePanel.removeAll();var param={limit:0,page:0,filter:"{}",dir:"ASC",sort:"SortNum",sessiontoken:GlobalFun.getSeesionToken()},codeVal=tombCode.getValue();codeVal.length>0&&(param.filter='{ "Area": { "Alias": "'+codeVal+'" }, "Row": { "Alias": "'+codeVal+'" }, "Column": { "Alias": "'+codeVal+'" } }'),WsCall.call(GlobalConfig.Controllers.TombstoneGrid.read,"LoadTombstoneGrid",param,function(response,opts){var data=response.dataset;GridManager.AreaTombstoneImagePanel.el.mask("请稍候...");var pngNStyle={border:"1px solid black","background-color":"#FFFFFF","background-image":"none","background-repeat":"no-repeat",cursor:"pointer"},items1=[],pngContainer=Ext.create("Ext.container.Container",{style:{"white-space":"nowrap",margin:"5px 5px 5px 5px"},items:[]}),rowMaps=new Ext.util.MixedCollection,areaSort="ASC";Ext.Array.each(data,function(item,index,allItems){var key=item.RowId;rowMaps.containsKey(key)?rowMaps.get(key).push(item):rowMaps.add(key,[item]),"DESC"==item.AreaSort&&(areaSort="DESC")}),rowMaps.sortByKey(areaSort),rowMaps.each(function(row,index){items1=[],pngContainer=Ext.create("Ext.container.Container",{style:{"white-space":"nowrap",margin:"5px 5px 5px 5px"},items:[]}),Ext.Array.each(row,function(item,index1){var src=GlobalFun.GetTomestoneImageSrc(item.PaymentStatusId,item.Id,item.TypeId),pngContainer1=Ext.create("Ext.container.Container",{width:100,height:80,tombstoneId:item.Id,layout:{type:"vbox",align:"center"},style:{display:"inline-block"},items:[{xtype:"image",sortNum:item.SortNum,tombstoneId:item.Id,PaymentStatusId:item.PaymentStatusId,tombstoneInfo:item,width:77,height:60,style:pngNStyle,src:src,listeners:{boxready:function(img){var imgDom=img.getEl();imgDom.on("click",function(eve){var tid=img.tombstoneId,tombstoneInfo=img.tombstoneInfo;GlobalFun.JobTombPngClickFun(eve,tid,tombstoneInfo)})}}},{xtype:"label",text:item.Alias}]});items1.push(pngContainer1)}),pngContainer.add(items1),GridManager.AreaTombstoneImagePanel.add(pngContainer)}),GridManager.AreaTombstoneImagePanel.el.unmask()},function(response,opts){GlobalFun.errorProcess(response.code)||Ext.Msg.alert("失败",response.msg)},!0,"请稍候...",GridManager.AreaTombstoneImagePanel.el)}}}},{text:"重置",xtype:"button",width:100,cls:"big-fieldtext",itemId:"reset",listeners:{click:function(field){var toolbar=field.up("container"),tombCode=toolbar.down("#tombCode");tombCode.setValue(""),tombCode.unsetActiveError(),tombCode.inputEl.focus(100)}}}]}],items:[]});
//# sourceMappingURL=exUnit.js.map
Ext.define("chl.Model.MainItemListTreeModel",{extend:"Ext.data.Model",fields:[{name:"id",type:"string"},{name:"text",type:"string"},{name:"leaf",type:"boolean"},{name:"iconCls",type:"string"},{name:"expanded",type:"boolean"},{name:"linksrc",type:"string"},{name:"parent"},{name:"children"},{name:"cls"},{name:"express_id"}]});
//# sourceMappingURL=MainItemListTreeModel.js.map
Ext.create("Ext.data.TreeStore",{model:"chl.Model.MainItemListTreeModel",storeId:"MainItemListTreeStoreId",root:{id:"000",expanded:!0,children:[{id:"001",text:"客户管理",iconCls:"customerGrid",leaf:!0},{id:"002",text:"票据管理",iconCls:"tracking_numberGrid",leaf:!0},{id:"003",text:"成本管理",expanded:!0,children:[{id:"0031",express_id:1,iconCls:"expressGrid",text:"圆通快递",leaf:!0}]}]}});
//# sourceMappingURL=MainItemListTreeStore.js.map
Ext.define("chl.tree.MainItemListTree",{alias:"widget.MainItemListTree",itemId:"MainItemListTree",title:"系统",iconCls:"home",extend:"chl.tree.BaseTree",clearOnLoad:!1,alternateClassName:["MainItemListTree"],store:"MainItemListTreeStoreId",ddGroup:"MainItemListTreeDDGp",animate:!1,rootVisible:!1,frame:!1,frameHeader:!1,border:!1,listeners:{itemcontextmenu:function(view,rec,item,index,e,opts){e.stopEvent()},expand:function(tree,opts){tree.getSelectionModel().hasSelection()?tree.fireEvent("selectionchange",tree,tree.getSelectionModel().getSelection(),opts):tree.getSelectionModel().select(0,!0)},boxready:function(com,width,height,opts){(new Ext.util.DelayedTask).delay(200,function(){if(!TreeManager.MainItemListTree.getSelectionModel().hasSelection()){var cookie=Ext.util.Cookies.get("GlobalConfig.globalStatus");if(cookie){var obj=Ext.JSON.decode(cookie);if(obj.tree_sel_id){var node=TreeManager.MainItemListTree.getStore().getNodeById(obj.tree_sel_id);node?TreeManager.MainItemListTree.getSelectionModel().select(node,!0):TreeManager.MainItemListTree.getSelectionModel().select(0,!0)}else TreeManager.MainItemListTree.getSelectionModel().select(0,!0)}else TreeManager.MainItemListTree.getSelectionModel().select(0,!0)}})}},initComponent:function(){var me=this;me.callParent(arguments)}}),TreeManager.CreateMainItemListTree=function(param){return TreeManager.MainItemListTree=Ext.create("chl.tree.MainItemListTree"),param&&param.needLoad&&TreeManager.MainItemListTree.getStore().load({callback:function(){var rootNode=TreeManager.MainItemListTree.getRootNode();rootNode.expand()}}),TreeManager.MainItemListTree},TreeManager.SetMainItemListTreeSelectionChangeEvent=function(param){TreeManager.MainItemListTree.on("selectionchange",function(view,seles,op){if(seles[0]){if(GlobalConfig.globalStatus.tree_sel_id=seles[0].data.id,Ext.util.Cookies.set("GlobalConfig.globalStatus",Ext.JSON.encode(GlobalConfig.globalStatus),new Date((new Date).getTime()+31536e6)),"root"==seles[0].data.id)return void GlobalFun.TreeSelChangeGrid("ManageDfGrid",GridManager.ManageDfGrid,"系统",!0);if("001"==seles[0].data.id)return void GlobalFun.TreeSelChangeGrid("CustomerGrid",GridManager.CustomerGrid,"客户列表");if("002"==seles[0].data.id)return void GlobalFun.TreeSelChangeGrid("Tracking_numberGrid",GridManager.Tracking_numberGrid,"票据列表");if("003"==seles[0].data.id)return void GlobalFun.TreeSelChangeGrid("CompanyPanel",GridManager.CompanyPanel,"快递公司",!0);if("0031"==seles[0].data.id){GlobalFun.TreeSelChangeGrid("ExpressPanel",GridManager.ExpressPanel,"各省规则",!0);var param={express_id:seles[0].data.express_id,sessiontoken:GlobalFun.getSeesionToken()};return void WsCall.call(GlobalConfig.Controllers.ExpressPanel.GetCustomer_numberCount,"GetCustomer_numberCount",param,function(response,opts){var data=response.data;Ext.Array.each(data,function(item,index,alls){var temp=GridManager.ExpressPanel.down("#lbl"+item.province_code);temp.setText("现有规则:"+item.count)})},function(response,opts){GlobalFun.errorProcess(response.code)||Ext.Msg.alert("失败",response.msg)},!0,!1,GridManager.ExpressPanel.el)}}})};
//# sourceMappingURL=MainItemListTree.js.map
Ext.create("Ext.data.ArrayStore",{storeId:"ManageDfGridStoreId",fields:[{name:"gridId",type:"string"},{name:"gridName",type:"string"}],autoLoad:!1,pageSize:10,data:[["001","客户管理"],["002","yy管理"]]}),Ext.define("chl.dfgrid.ManageDfGrid",{alternateClassName:["ManageDfGrid"],alias:"widget.ManageDfGrid",extend:"Ext.grid.Panel",store:"ManageDfGridStoreId",actionBaseName:"ManageDfGrid",itemId:"ManageDfGrid",FirstLoad:!0,hideHeaders:!0,viewConfig:{loadMask:!1},columns:[{groupable:!1,sortable:!1,dataIndex:"gridName",renderer:GlobalFun.UpdateRecord,flex:1}],listeners:{itemclick:function(view,record){var node=TreeManager.MainItemListTree.getStore().getNodeById(record.data.gridId);TreeManager.MainItemListTree.getSelectionModel().select(node,!0)},itemmouseenter:function(view,record,item,index,e,eOpts){item.style.cursor="pointer"},itemmouseleave:function(view,record,item,index,e,eOpts){item.style.cursor="auto"}}});
//# sourceMappingURL=ManageDfGrid.js.map
StoreManager.ComboStore.ProvinceStore=Ext.create("Ext.data.Store",{storeId:"ProvinceStoreId",fields:["Id","Name"],data:GlobalFun.JsonToArray(GlobalConfig.Province)}),StoreManager.ComboStore.Tracking_numberGridTypeStore=Ext.create("Ext.data.Store",{storeId:"Tracking_numberGridTypeStoreId",fields:["Id","Name"],data:[{Id:0,Name:"未结算"},{Id:1,Name:"已结算"}]});
//# sourceMappingURL=ComboStore.js.map
function createPlugin(){Customer_numberGridRowEditing=Ext.create("Ext.grid.plugin.RowEditing",{clicksToMoveEditor:1,autoCancel:!0,listeners:{edit:function(editor,e,opts){var sm=e.grid.getSelectionModel();e.store.sync({success:function(batch,opts){e.store.getCount()>0&&sm.select(0)},failure:function(batch,opts){Ext.Msg.alert("失败",action.result.msg)}})},canceledit:function(editor,e,opts){e.store.load()},beforeedit:function(editor,e,opts){}}})}Ext.define("chl.Model.Customer_numberGridModel",{extend:"Ext.data.Model",idProperty:"number_id",alternateClassName:["Customer_numberGridModel"],fields:[{name:"number_id"},{name:"customer_id"},{name:"customer_name"},{name:"customize_number_prefix"},{name:"customize_number_from"},{name:"customize_number_to"},{name:"customize_number_suffix"}]}),Ext.create("Ext.data.Store",{model:"chl.Model.Customer_numberGridModel",storeId:"Customer_numberStoreId",filterMap:Ext.create("Ext.util.HashMap"),pageSize:GlobalConfig.GridPageSize,autoSync:!1,autoLoad:!1,remoteSort:!0,sorters:[{property:"customer_id",direction:"DESC"}],proxy:{type:"ajax",api:GlobalConfig.Controllers.Customer_numberGrid,filterParam:"filter",sortParam:"sort",directionParam:"dir",limitParam:"limit",startParam:"start",simpleSortMode:!0,extraParams:{req:"data",dataname:"Customer_number",restype:"json",sessiontoken:GlobalFun.getSeesionToken(),folderid:-1,refresh:null,template:""},reader:{type:"json",root:"data",seccessProperty:"success",messageProperty:"msg",totalProperty:"total"},writer:{type:"json"},actionMethods:{create:"POST",read:"POST",update:"POST",destroy:"POST"},listeners:{exception:function(proxy,response,operation){var json=Ext.JSON.decode(response.responseText),code=json.code;GlobalFun.errorProcess(code),"read"!=operation.action}}},listeners:{load:function(store,records,suc,operation,opts){store.getTotalCount();suc||store.loadData([])}}});var Customer_numberGridRowEditing;createPlugin(),Ext.define("chl.gird.Customer_numberGrid",{extend:"chl.grid.BaseGrid",alternateClassName:["Customer_numberGrid"],alias:"widget.Customer_numberGrid",store:"Customer_numberStoreId",columnLines:!0,multiSelect:!0,actionBaseName:"Customer_numberGridAction",dockedItems:[{xtype:"Pagingtoolbar",itemId:"pagingtoolbarID",store:"Customer_numberStoreId",dock:"bottom",items:[]}],listeners:{itemclick:function(grid,record,hitem,index,e,opts){},itemdblclick:function(grid,record,hitem,index,e,opts){},itemcontextmenu:function(view,rec,item,index,e,opts){e.stopEvent(),CustomerRentGrid_RightMenu.showAt(e.getXY())},beforeitemmousedown:function(view,record,item,index,e,options){},selectionchange:function(view,seles,op){if(seles[0]){var me=this;me.down("#removeCustomer_number").setDisabled(!seles.length)}}},tbar:[{text:"刷新",tooltip:"刷新",iconCls:"refresh",handler:function(){Ext.StoreMgr.lookup("Customer_numberStoreId").load()}},{text:"添加",tooltip:"添加客户面单号范围",iconCls:"add",handler:function(){Customer_numberGridRowEditing.cancelEdit();var r=Ext.ModelManager.create({number_id:"",customer_id:WindowManager.AddUpdateCustomer_numberWin.record.data.customer_id,customer_name:WindowManager.AddUpdateCustomer_numberWin.record.data.customer_name,customize_number_prefix:"",customize_number_from:"",customize_number_to:"",customize_number_suffix:""},"chl.Model.Customer_numberGridModel");Ext.StoreMgr.lookup("Customer_numberStoreId").insert(0,r),Customer_numberGridRowEditing.startEdit(0,1)}},{itemId:"removeCustomer_number",text:"删除",tooltip:"删除",iconCls:"remove",handler:function(){var me=this,grid=me.up("Customer_numberGrid"),sm=me.up("Customer_numberGrid").getSelectionModel(),records=sm.getSelection();Customer_numberGridRowEditing.cancelEdit(),Ext.StoreMgr.lookup("Customer_numberStoreId").remove(records),Ext.StoreMgr.lookup("Customer_numberStoreId").sync({success:function(batch,opts){grid.loadGrid(),Ext.StoreMgr.lookup("Customer_numberStoreId").getCount()>0&&sm.select(0)},failure:function(batch,opts){Ext.Msg.alert("失败",action.result.msg)}})},disabled:!0}],columns:[{header:"编号",dataIndex:"number_id",flex:1,renderer:function(value){return value}},{header:"面单号前缀",dataIndex:"customize_number_prefix",flex:1,editor:{maxLength:20,maxLengthText:"长度最大为20字节"}},{header:"面单号起始编号",dataIndex:"customize_number_from",flex:1,editor:{allowBlank:!1,blankText:"不能为空",maxLength:20,maxLengthText:"长度最大为20字节",regex:GlobalConfig.RegexController.regexNumber,regexText:"请输入数字"}},{header:"面单号截止编号",dataIndex:"customize_number_to",flex:1,editor:{allowBlank:!1,blankText:"不能为空",maxLength:20,maxLengthText:"长度最大为20字节",regex:GlobalConfig.RegexController.regexNumber,regexText:"请输入数字"}},{header:"面单号后缀",dataIndex:"customize_number_suffix",flex:1,editor:{maxLength:20,maxLengthText:"长度最大为20字节"}}],initComponent:function(){var me=this;me.callParent(arguments),ActionBase.setTargetView(me.actionBaseName,me),ActionBase.updateActions(me.actionBaseName,me.getSelectionModel().getSelection())},loadGrid:function(isSearch){var me=this,store=me.getStore(),sessiontoken=store.getProxy().extraParams.sessiontoken;!sessiontoken||0==sessiontoken.length;var filter={};store.filterMap.each(function(key,value,length){filter[key]=value}),store.getProxy().extraParams.filter=Ext.JSON.encode(filter),store.getProxy().extraParams.refresh=1,store.loadPage(1),store.getProxy().extraParams.refresh=null,ActionBase.updateActions(me.actionBaseName,me.getSelectionModel().getSelection())}}),Ext.define("chl.Grid.AddUpdateCustomer_numberWin",{extend:"Ext.window.Window",title:"添加",iconCls:"",record:!1,height:700,width:830,bodyPadding:10,layout:"fit",modal:!0,resizable:!1,items:[],buttons:[{text:"关闭",handler:function(){var me=this;Customer_numberGridRowEditing.cancelEdit(),me.up("window").close()}}],listeners:{boxready:function(win){createPlugin(),win.add({xtype:"Customer_numberGrid",itemId:"Customer_numberGrid",plugins:[Customer_numberGridRowEditing]});var grid=win.down("Customer_numberGrid"),store=grid.getStore();store.getProxy().extraParams.customer_id=win.record.data.customer_id,win.down("Customer_numberGrid").loadGrid()}}});
//# sourceMappingURL=Customer_numberGrid.js.map
Ext.define("chl.Model.CustomerRentGridModel",{extend:"Ext.data.Model",idProperty:"Id",alternateClassName:["CustomerRentGridModel"],fields:[{name:"customer_rent_id",type:"string"},{name:"customer_id",type:"string"},{name:"title",type:"string"},{name:"rent_area",type:"string"},{name:"area_to_order_number",type:"string"},{name:"rent_pre_price",type:"string"},{name:"date_start",type:"string"},{name:"date_end",type:"string"}]});
//# sourceMappingURL=CustomerRentGridModel.js.map
Ext.create("Ext.data.Store",{model:"chl.Model.CustomerRentGridModel",storeId:"CustomerRentGridStoreId",filterMap:Ext.create("Ext.util.HashMap"),pageSize:GlobalConfig.GridPageSize,autoLoad:!1,remoteSort:!0,sorters:[{property:"customer_rent_id",direction:"DESC"}],autoSync:!1,proxy:{type:"ajax",api:GlobalConfig.Controllers.CustomerRentGrid,filterParam:"filter",sortParam:"sort",directionParam:"dir",limitParam:"limit",startParam:"start",simpleSortMode:!0,extraParams:{req:"data",dataname:"User",restype:"json",sessiontoken:GlobalFun.getSeesionToken(),folderid:-1,refresh:null,template:""},reader:{type:"json",root:"data",seccessProperty:"success",messageProperty:"msg",totalProperty:"total"},writer:{type:"json",writeAllFields:!1,allowSingle:!1},actionMethods:{create:"POST",read:"POST",update:"POST",destroy:"POST"},listeners:{exception:function(proxy,response,operation){var json=Ext.JSON.decode(response.responseText),code=json.code;GlobalFun.errorProcess(code),"read"!=operation.action}}},listeners:{load:function(store,records,suc,operation,opts){store.getTotalCount();suc||store.loadData([])}}});
//# sourceMappingURL=CustomerRentGridStore.js.map
Ext.define("chl.Action.CustomerRentGridAction",{extend:"WS.action.Base",category:"CustomerRentGridAction"}),Ext.create("chl.Action.CustomerRentGridAction",{itemId:"editCustomerRule",iconCls:"editCustomerRule",tooltip:"添加规则",text:"添加规则",handler:function(){var me=this,target=me.getTargetView(),record=target.getSelectionModel().getSelection()[0];ActionManager.editCustomerRule(target,record)},updateStatus:function(selection){this.setDisabled(1!=selection.length)}}),Ext.create("chl.Action.CustomerRentGridAction",{itemId:"refreshCustomerRent",iconCls:"refresh",tooltip:"刷新",text:"刷新",handler:function(){var target=this.getTargetView();ActionManager.refreshCustomerRent(target)},updateStatus:function(selection){}}),ActionManager.refreshCustomerRent=function(target){target.loadGrid()};var CustomerRentGrid_RightMenu=Ext.create("Ext.menu.Menu",{items:[ActionBase.getAction("refreshCustomerRent"),"-",ActionBase.getAction("editCustomerRule")]});Ext.define("chl.gird.CustomerRentGrid",{alternateClassName:["CustomerRentGrid"],alias:"widget.CustomerRentGrid",extend:"chl.grid.BaseGrid",store:"CustomerRentGridStoreId",actionBaseName:"CustomerRentGridAction",listeners:{itemclick:function(grid,record,hitem,index,e,opts){},itemdblclick:function(grid,record,hitem,index,e,opts){ActionBase.getAction("editCustomerRule").execute()},itemcontextmenu:function(view,rec,item,index,e,opts){e.stopEvent(),CustomerRentGrid_RightMenu.showAt(e.getXY())},beforeitemmousedown:function(view,record,item,index,e,options){},selectionchange:function(view,seles,op){seles[0]&&ActionBase.updateActions("CustomerRentGridAction",seles)}},columns:[{text:"编号",dataIndex:"customer_rent_id",renderer:GlobalFun.UpdateRecord,width:100},{text:"租贷面积(平米)",dataIndex:"rent_area",renderer:GlobalFun.UpdateRecord,width:100},{text:"面积单量比",dataIndex:"area_to_order_number",renderer:GlobalFun.UpdateRecord,width:100},{text:"房租单价",dataIndex:"rent_pre_price",renderer:GlobalFun.UpdateRecord,width:100},{text:"开始日期",dataIndex:"date_start",renderer:GlobalFun.UpdateRecord,width:100},{text:"结束日期",dataIndex:"date_end",renderer:GlobalFun.UpdateRecord,width:100}],dockedItems:[{xtype:"toolbar",itemId:"toolbarID",dock:"top",layout:{overflowHandler:"Menu"},items:[ActionBase.getAction("refreshCustomerRent"),"-",ActionBase.getAction("editCustomerRule")]},{xtype:"Pagingtoolbar",itemId:"pagingtoolbarID",store:"CustomerRentGridStoreId",dock:"bottom",items:[]}],initComponent:function(){var me=this;me.callParent(arguments),ActionBase.setTargetView(me.actionBaseName,me),ActionBase.updateActions(me.actionBaseName,me.getSelectionModel().getSelection())},loadGrid:function(isSearch){var me=this,store=me.getStore(),sessiontoken=store.getProxy().extraParams.sessiontoken;!sessiontoken||0==sessiontoken.length;var filter={};store.filterMap.each(function(key,value,length){filter[key]=value}),store.getProxy().extraParams.filter=Ext.JSON.encode(filter),store.getProxy().extraParams.refresh=1,store.loadPage(1),store.getProxy().extraParams.refresh=null,ActionBase.updateActions(me.actionBaseName,me.getSelectionModel().getSelection())}}),GridManager.CreateCustomerRentGrid=function(param){var tmpArr=[{text:"编号",dataIndex:"customer_rent_id",renderer:GlobalFun.UpdateRecord,width:100},{text:"合同名",dataIndex:"title",renderer:GlobalFun.UpdateRecord,width:100},{text:"租贷面积(平米)",dataIndex:"rent_area",renderer:GlobalFun.UpdateRecord,width:100},{text:"面积单量比",dataIndex:"area_to_order_number",renderer:GlobalFun.UpdateRecord,width:100},{text:"房租单价",dataIndex:"rent_pre_price",renderer:GlobalFun.UpdateRecord,width:100},{text:"开始日期",dataIndex:"date_start",renderer:GlobalFun.UpdateRecord,width:100},{text:"结束日期",dataIndex:"date_end",renderer:GlobalFun.UpdateRecord,width:100}];return GridManager.CustomerRentGrid=Ext.create("chl.gird.CustomerRentGrid",GridManager.BaseGridCfg("CustomerRentGrid","CustomerRentGridState",tmpArr)),param&&param.needLoad&&GridManager.CustomerRentGrid.loadGrid(),GridManager.CustomerRentGrid},GridManager.SetCustomerRentGridSelectionChangeEvent=function(param){GridManager.CustomerRentGrid.on("selectionchange",function(view,seles,op){!seles[0]})},ActionManager.editCustomerRule=function(target,record){var param={customer_rent_id:record.data.customer_rent_id,sessiontoken:GlobalFun.getSeesionToken()};WsCall.call(GlobalConfig.Controllers.CustomerGrid.GetCustomerRuleByRentId,"GetCustomerRuleByRentId",param,function(response,opts){var data=response.data;WindowManager.AddUpdateCustomerRuleWin=Ext.create("chl.Grid.AddUpdateCustomerRuleWin",{grid:target,iconCls:"editCustomerRule",record:record,action:"update",title:"添加规则"}),WindowManager.AddUpdateCustomerRuleWin.show(null,function(){Ext.Array.each(data,function(item,index,alls){var temp=WindowManager.AddUpdateCustomerRuleWin.down("#lbl"+item.province_code);temp.setText("现有规则:"+item.count)}),WindowManager.AddUpdateCustomerRuleWin.down("#formId").loadRecord(record)})},function(response,opts){GlobalFun.errorProcess(response.code)||Ext.Msg.alert("失败",response.msg)},!0)},Ext.define("chl.Grid.AddUpdateCustomerRuleWin",{extend:"Ext.window.Window",title:"添加",defaultFocus:"CustomerItemId",iconCls:"",record:!1,height:500,width:830,layout:"vbox",modal:!0,resizable:!1,items:[{xtype:"form",itemId:"formId",autoScroll:!0,height:450,width:810,border:!1,bodyPadding:5,defaultType:"displayfield",layout:{type:"table",columns:2},defaults:{labelAlign:"right",labelPad:15,width:340,labelWidth:125,maxLength:100,maxLengthText:"最大长度为100"},items:[{name:"customer_name",fieldLabel:"客户名",itemId:"customer_nameItemId",validateOnBlur:!1,allowBlank:!1,blankText:"不能为空"},{name:"mobile",fieldLabel:"手机号",itemId:"mobileItemId",validateOnBlur:!1,allowBlank:!1,blankText:"不能为空"},{name:"rent_area",fieldLabel:"租贷面积（平米）",itemId:"rent_areaItemId",validateOnBlur:!1,allowBlank:!1,blankText:"不能为空",regex:GlobalConfig.RegexController.regexNumber,regexText:"请输入数字"},{name:"area_to_order_number",fieldLabel:"面积单量比",itemId:"area_to_order_numberItemId",validateOnBlur:!1,allowBlank:!1,blankText:"不能为空",regex:GlobalConfig.RegexController.regexMoney2Fixed,regexText:"请输入数字"},{name:"rent_pre_price",fieldLabel:"房租单价",validateOnBlur:!1,colspan:2,allowBlank:!1,blankText:"不能为空",regex:GlobalConfig.RegexController.regexMoney2Fixed,regexText:"请输入数字"},{minValue:new Date,name:"date_start",format:"Y-m-d",fieldLabel:"开始时间",allowBlank:!1,blankText:"不能为空",itemId:"date_start",vtype:"daterange",endDateField:"date_end"},{minValue:new Date,name:"date_end",format:"Y-m-d",fieldLabel:"结束时间",allowBlank:!1,blankText:"不能为空",itemId:"date_end",vtype:"daterange",startDateField:"date_start"},{xtype:"fieldset",colspan:2,title:"规则",itemId:"fs_rule",collapsible:!0,padding:"2 2 2 5",width:780,defaults:{labelAlign:"right",labelPad:15,xtype:"fieldset",defaults:{labelAlign:"right",labelPad:15,width:340,labelWidth:125,maxLength:100}},items:[],listeners:{boxready:function(com){var itemsArr=(com.up("window"),[]);for(key in GlobalConfig.Province)itemsArr.push({title:GlobalConfig.Province[key],items:[{xtype:"label",text:"现有规则:0",itemId:"lbl"+key},{xtype:"button",margin:"0 0 0 20",width:100,iconCls:"btnAdd",text:"添加规则",myval:key,handler:function(com){var param={customer_rent_id:WindowManager.AddUpdateCustomerRuleWin.record.data.customer_rent_id,province_code:com.myval,sessiontoken:GlobalFun.getSeesionToken()};WsCall.call(GlobalConfig.Controllers.CustomerGrid.getCustomerRule,"GetCustomerRule",param,function(response,opts){function createRuleRow(rowData){var tempRuleItems=[];return Ext.Array.each(rowData,function(item,index,alls){var obj={};obj="0"==item.price_type?{xtype:"fieldset",collapsible:!0,title:'<font style="font-size:14px;">固定价格</font>',width:770,layout:{type:"table",columns:2},defaults:{xtype:"displayfield",labelAlign:"right",labelPad:15,width:340,labelWidth:125,maxLength:100,maxLengthText:"最大长度为100"},items:[{fieldLabel:"起价",value:item.price_start},{fieldLabel:"后续单价",value:item.price_pre},{xtype:"button",rule_id:item.rule_id,colspan:2,width:100,margin:"0 0 0 630",text:"删除",handler:function(com){var rule_id=com.rule_id,param={rule_id:rule_id,sessiontoken:GlobalFun.getSeesionToken()};WsCall.call(GlobalConfig.Controllers.CustomerGrid.delCustomerRule,"delCustomerRule",param,function(response,opts){com.up("fieldset").destroy()},function(response,opts){GlobalFun.errorProcess(response.code)||Ext.Msg.alert("失败",response.msg)},!0,!1,com.up("window").getEl())}}]}:{xtype:"fieldset",legend:{xtype:"component",style:{height:40,"background-color":"red"}},title:'<font style="font-size:14px;">步进价格  [ 首重区间(kg): <font style="color:red;">'+item.weight_min+"-"+item.weight_max+"</font> ]</font>",width:770,collapsible:!0,layout:{type:"table",columns:2},defaults:{xtype:"displayfield",labelAlign:"right",labelPad:15,width:340,labelWidth:125,maxLength:100,maxLengthText:"最大长度为100"},items:[{fieldLabel:"首重价格",value:item.weight_start_price,colspan:2},{fieldLabel:"续重重量(kg)",value:item.weight_pre},{fieldLabel:"续重价格",value:item.weight_pre_price},{fieldLabel:"记重方式",value:item.weight_price_type_name},{fieldLabel:"排序",value:item.sort_order},{xtype:"button",colspan:2,rule_id:item.item_id,width:100,margin:"0 0 0 630",text:"删除",handler:function(com){var rule_id=com.rule_id,param={item_id:rule_id,sessiontoken:GlobalFun.getSeesionToken()};WsCall.call(GlobalConfig.Controllers.CustomerGrid.delCustomerRule,"delCustomerRule",param,function(response,opts){com.up("fieldset").destroy()},function(response,opts){GlobalFun.errorProcess(response.code)||Ext.Msg.alert("失败",response.msg)},!0,!1,com.up("window").getEl())}}]},tempRuleItems.push(obj)}),tempRuleItems}var data=response.data;Ext.create("Ext.window.Window",{title:"添加规则("+GlobalConfig.Province[com.myval]+")",pid:com.myval,width:820,height:700,iconCls:"editCustomerRule",resizable:!1,action:"create",modal:!0,autoScroll:!0,layout:"vbox",bodyPadding:10,dockedItems:[{xtype:"container",dock:"top",border:!1,bodyPadding:15,layout:{type:"table",columns:2},defaultType:"textfield",defaults:{labelAlign:"right",labelPad:15,width:340,labelWidth:125,maxLength:100,maxLengthText:"最大长度为100"},items:[{xtype:"fieldcontainer",colspan:2,fieldLabel:"计价方式",defaultType:"radiofield",layout:"hbox",defaults:{flex:1},items:[{boxLabel:"固定价格",checked:!0,itemId:"rd_price0",name:"price_type",inputValue:"0",listeners:{change:function(com,nval,oval,opts){var me=this,win=me.up("window");nval?(win.down("#price_type0").show(),win.down("#price_type1").hide()):(win.down("#price_type1").show(),win.down("#price_type0").hide())}}},{boxLabel:"步进价格",itemId:"rd_price1",name:"price_type",inputValue:"1"}]},{xtype:"form",itemId:"price_type0",height:100,width:810,bodyPadding:15,layout:{type:"table",columns:2},defaults:{labelAlign:"right",labelPad:15,width:340,labelWidth:125,maxLength:100,maxLengthText:"最大长度为100"},items:[{xtype:"numberfield",fieldLabel:"起价",name:"price_start",minValue:0,decimalPrecision:3,maxValue:GlobalConfig.MaxLimit,allowBlank:!1,blankText:"不能为空"},{xtype:"numberfield",fieldLabel:"后续单价",name:"price_pre",minValue:0,decimalPrecision:3,maxValue:GlobalConfig.MaxLimit,allowBlank:!1,blankText:"不能为空"},{xtype:"button",itemId:"btn_add",colspan:2,margin:"0 0 0 580",width:100,text:"添加",handler:function(com){var me=this,w=me.up("window"),form=w.down("#price_type0").getForm();form.isValid()&&GlobalConfig.newMessageBox.show({title:"提示",msg:"添加固定价格将覆盖已有的所有价格设置，是否继续?",buttons:Ext.MessageBox.YESNO,closable:!1,fn:function(btn){if("yes"==btn){var url=GlobalConfig.Controllers.CustomerGrid.addCustomerRule;form.submit({url:url,params:{req:"dataset",dataname:"addCustomerRule",restype:"json",price_type:0,province_code:w.pid,action:w.action,customer_rent_id:WindowManager.AddUpdateCustomerRuleWin.record.data.customer_rent_id,sessiontoken:GlobalFun.getSeesionToken()},success:function(form,action){var data=action.result.data,arr=createRuleRow(data);w.removeAll(),w.add(arr)},failure:function(form,action){GlobalFun.errorProcess(action.result.code)||Ext.Msg.alert("失败",action.result.msg)}})}},icon:Ext.MessageBox.QUESTION})}}]},{xtype:"form",colspan:2,bodyPadding:15,itemId:"price_type1",height:280,width:810,layout:{type:"table",columns:2},hidden:!0,items:[{xtype:"fieldset",title:"首重",width:780,colspan:2,layout:{type:"table",columns:2},defaults:{labelAlign:"right",labelPad:15,width:340,labelWidth:125},items:[{xtype:"numberfield",name:"weight_min",fieldLabel:"起始重量(kg)",minValue:0,value:0,decimalPrecision:3,maxValue:GlobalConfig.MaxLimit,allowBlank:!1,blankText:"不能为空"},{xtype:"numberfield",name:"weight_max",fieldLabel:"结束重量(kg)",minValue:0,value:1,maxValue:GlobalConfig.MaxLimit,decimalPrecision:3,allowBlank:!1,blankText:"不能为空"},{xtype:"numberfield",span:2,name:"weight_start_price",fieldLabel:"价格",decimalPrecision:2,minValue:0,maxValue:GlobalConfig.MaxLimit,regex:GlobalConfig.RegexController.regexMoney2Fixed,regexText:"请填写两位小数的数字",allowBlank:!1,blankText:"不能为空"}]},{xtype:"fieldset",title:"续重",width:780,layout:{type:"table",columns:2},defaults:{labelAlign:"right",labelPad:15,width:340,labelWidth:125},colspan:2,items:[{xtype:"numberfield",name:"weight_pre",fieldLabel:"重量(kg)",minValue:0,maxValue:GlobalConfig.MaxLimit,decimalPrecision:3,allowBlank:!1,blankText:"不能为空"},{xtype:"numberfield",name:"weight_pre_price",fieldLabel:"价格",decimalPrecision:2,minValue:0,maxValue:GlobalConfig.MaxLimit,allowBlank:!1,blankText:"不能为空"},{xtype:"fieldcontainer",colspan:2,fieldLabel:"记重方式",defaultType:"radiofield",layout:"hbox",defaults:{flex:1},items:[{boxLabel:"进位",checked:!0,name:"weight_price_type",inputValue:"0"},{boxLabel:"实重",name:"weight_price_type",inputValue:"1"}]}]},{fieldLabel:"排序",xtype:"numberfield",name:"sort_order",decimalPrecision:0,minValue:1,value:1},{xtype:"button",width:100,text:"添加",handler:function(com){var me=this,w=me.up("window"),form=w.down("#price_type1").getForm();if(form.isValid()){var url=GlobalConfig.Controllers.CustomerGrid.addCustomerRule;form.submit({url:url,params:{req:"dataset",dataname:"addCustomerRule",restype:"json",price_type:1,province_code:w.pid,action:w.action,customer_rent_id:WindowManager.AddUpdateCustomerRuleWin.record.data.customer_rent_id,sessiontoken:GlobalFun.getSeesionToken()},success:function(form,action){var data=action.result.data,arr=createRuleRow(data);w.removeAll(),w.add(arr)},failure:function(form,action){GlobalFun.errorProcess(action.result.code)||Ext.Msg.alert("失败",action.result.msg)}})}}}]}]}],items:[],listeners:{boxready:function(com){var tempRuleItems=createRuleRow(data);com.add(tempRuleItems)},beforehide:function(com){var param={customer_rent_id:WindowManager.AddUpdateCustomerRuleWin.record.data.customer_rent_id,sessiontoken:GlobalFun.getSeesionToken()};WsCall.call(GlobalConfig.Controllers.CustomerGrid.GetCustomerRuleByRentId,"GetCustomerRuleByRentId",param,function(response,opts){var data=response.data;Ext.Array.each(data,function(item,index,alls){var temp=WindowManager.AddUpdateCustomerRuleWin.down("#lbl"+item.province_code);temp.setText("现有规则:"+item.count)})},function(response,opts){GlobalFun.errorProcess(response.code)||Ext.Msg.alert("失败",response.msg)},!1)}},buttons:[{text:"退出",handler:function(){var me=this;me.up("window").close()}}]}).show()},function(response,opts){GlobalFun.errorProcess(response.code)||Ext.Msg.alert("失败",response.msg)},!1)}}]});com.add(itemsArr)}}}]}],buttons:[{text:"关闭",handler:function(){var me=this;me.up("window").close()}}]});
//# sourceMappingURL=CustomerRentGrid.js.map
Ext.define("chl.Action.CustomerGridAction",{extend:"WS.action.Base",category:"CustomerGridAction"}),Ext.create("chl.Action.CustomerGridAction",{itemId:"addCustomer",iconCls:"add",tooltip:"添加客户",text:"添加客户",handler:function(){var me=this,target=me.getTargetView();ActionManager.addCustomer(target)},updateStatus:function(selection){}}),Ext.create("chl.Action.CustomerGridAction",{itemId:"editCustomer",iconCls:"edit",tooltip:"编辑客户",text:"编辑客户",handler:function(){var me=this,target=me.getTargetView(),record=target.getSelectionModel().getSelection()[0];ActionManager.editCustomer(target,record)},updateStatus:function(selection){this.setDisabled(1!=selection.length)}}),Ext.create("chl.Action.CustomerGridAction",{itemId:"searchCustomer",iconCls:"search",tooltip:"查询",text:"查询",handler:function(){var target=this.getTargetView();ActionManager.searchCustomer(target)},updateStatus:function(selection){}}),Ext.create("chl.Action.CustomerGridAction",{itemId:"editCustomer_number",iconCls:"eidtCustomer_number",tooltip:"管理客户面单号范围",text:"管理面单号范围",handler:function(){var me=this,target=me.getTargetView(),record=target.getSelectionModel().getSelection()[0];ActionManager.editCustomer_number(target,record)},updateStatus:function(selection){this.setDisabled(1!=selection.length)}}),Ext.create("chl.Action.CustomerGridAction",{itemId:"addCustomerRent",iconCls:"addCustomerRent",tooltip:"添加合同/规则",text:"添加合同/规则",handler:function(){var me=this,target=me.getTargetView(),record=target.getSelectionModel().getSelection()[0];ActionManager.addCustomerRent(target,record)},updateStatus:function(selection){this.setDisabled(1!=selection.length)}}),Ext.create("chl.Action.CustomerGridAction",{itemId:"refreshCustomer",iconCls:"refresh",tooltip:"刷新",text:"刷新",handler:function(){var target=this.getTargetView();ActionManager.refreshCustomer(target)},updateStatus:function(selection){}}),ActionManager.refreshCustomer=function(target){target.loadGrid()},ActionManager.addCustomer=function(target){WindowManager.AddUpdateCustomerWin=Ext.create("chl.Grid.AddUpdateCustomerWin",{grid:target,iconCls:"add",action:"create",record:null,title:"新增"}),WindowManager.AddUpdateCustomerWin.show(null,function(){})},ActionManager.editCustomer=function(target,record){WindowManager.AddUpdateCustomerWin=Ext.create("chl.Grid.AddUpdateCustomerWin",{grid:target,iconCls:"edit",action:"update",record:null,title:"编辑"}),WindowManager.AddUpdateCustomerWin.show(null,function(){WindowManager.AddUpdateCustomerWin.down("#formId").loadRecord(record)})},ActionManager.editCustomer_number=function(target,record){WindowManager.AddUpdateCustomer_numberWin=Ext.create("chl.Grid.AddUpdateCustomer_numberWin",{grid:target,iconCls:"eidtCustomer_number",action:"create",record:record,title:"面单号范围(当前客户:"+record.data.customer_name+")"}),WindowManager.AddUpdateCustomer_numberWin.show(null,function(){})},ActionManager.addCustomerRent=function(target,record){WindowManager.AddUpdateCustomerRentWin=Ext.create("chl.Grid.AddUpdateCustomerRentWin",{grid:target,iconCls:"addCustomerRent",action:"create",record:record,title:"添加合同/规则"}),WindowManager.AddUpdateCustomerRentWin.show(null,function(){var grid=WindowManager.AddUpdateCustomerRentWin.down("CustomerRentGrid");grid.store.getProxy().extraParams.customer_id=record.data.customer_id,grid.loadGrid(),WindowManager.AddUpdateCustomerRentWin.down("#formId").loadRecord(record)})},ActionManager.searchCustomer=function(traget){WindowManager.searchCustomerWin&&""!=WindowManager.searchCustomerWin?WindowManager.searchCustomerWin.show():WindowManager.searchCustomerWin=Ext.create("Ext.window.Window",{modal:!0,resizable:!1,closeAction:"hide",title:"查询",defaultFocus:"customer_nameItemId",iconCls:"search",record:!1,height:200,width:500,layout:"vbox",items:[{xtype:"form",itemId:"formId",autoScroll:!0,height:190,width:500,border:!1,bodyPadding:15,defaultType:"textfield",layout:{type:"table",columns:1},defaults:{labelAlign:"right",labelPad:15,width:340,labelWidth:125,maxLength:36},items:[{name:"customer_name",fieldLabel:"客户名",itemId:"customer_nameItemId"},{name:"mobile",fieldLabel:"手机号",itemId:"mobileItemId"}]}],buttons:[{text:"重置",handler:function(){var me=this,w=me.up("window"),f=w.down("#formId");f.getForm().reset()}},{text:"确定",itemId:"submit",handler:function(){var me=this,win=me.up("window"),searchFlag=!1,store=traget.getStore(),form=(store.getProxy().extraParams,win.down("#formId").getForm());if(form.isValid()){var customer_name=win.down("#customer_nameItemId").getValue();""!=customer_name?(GlobalFun.GridSearchInitFun("customer_name",!1,store,customer_name),searchFlag=!0):GlobalFun.GridSearchInitFun("customer_name",!0,store,!1);var mobile=win.down("#mobileItemId").getValue();""!=mobile?(GlobalFun.GridSearchInitFun("mobile",!1,store,mobile),searchFlag=!0):GlobalFun.GridSearchInitFun("mobile",!0,store,!1),searchFlag?(win.close(),traget.loadGrid(!0)):(win.close(),traget.loadGrid())}}},{text:"取消",handler:function(){var me=this;me.up("window").close()}}]}).show()};
//# sourceMappingURL=CustomerGridAction.js.map
Ext.define("chl.Model.CustomerGridModel",{extend:"Ext.data.Model",idProperty:"Id",alternateClassName:["CustomerGridModel"],fields:[{name:"customer_id",type:"string"},{name:"customer_name",type:"string"},{name:"real_name",type:"string"},{name:"mobile",type:"string"},{name:"customize_number_from",type:"string"},{name:"customize_number_to",type:"string"},{name:"customer_rent_id",type:"string"},{name:"rent_area",type:"string"},{name:"area_to_order_number",type:"string"},{name:"rent_pre_price",type:"string"},{name:"date_start",type:"string"},{name:"date_end",type:"string"},{name:"updated_at",type:"string"}]});
//# sourceMappingURL=CustomerGridModel.js.map
Ext.create("Ext.data.Store",{model:"chl.Model.CustomerGridModel",storeId:"CustomerGridStoreId",filterMap:Ext.create("Ext.util.HashMap"),pageSize:GlobalConfig.GridPageSize,autoLoad:!1,remoteSort:!0,sorters:[{property:"customer_id",direction:"DESC"}],autoSync:!1,proxy:{type:"ajax",api:GlobalConfig.Controllers.CustomerGrid,filterParam:"filter",sortParam:"sort",directionParam:"dir",limitParam:"limit",startParam:"start",simpleSortMode:!0,extraParams:{req:"data",dataname:"Customer",restype:"json",sessiontoken:GlobalFun.getSeesionToken(),folderid:-1,refresh:null,template:""},reader:{type:"json",root:"data",seccessProperty:"success",messageProperty:"msg",totalProperty:"total"},writer:{type:"json",writeAllFields:!1,allowSingle:!1},actionMethods:{create:"POST",read:"POST",update:"POST",destroy:"POST"},listeners:{exception:function(proxy,response,operation){var json=Ext.JSON.decode(response.responseText),code=json.code;GlobalFun.errorProcess(code),"read"!=operation.action}}},listeners:{load:function(store,records,suc,operation,opts){store.getTotalCount();suc||store.loadData([])}}});
//# sourceMappingURL=CustomerGridStore.js.map
var CustomerGrid_RightMenu=Ext.create("Ext.menu.Menu",{items:[ActionBase.getAction("refreshCustomer"),"-",ActionBase.getAction("searchCustomer"),ActionBase.getAction("addCustomer"),ActionBase.getAction("editCustomer"),"-",ActionBase.getAction("editCustomer_number"),ActionBase.getAction("addCustomerRent")]});Ext.define("chl.gird.CustomerGrid",{alternateClassName:["CustomerGrid"],alias:"widget.CustomerGrid",extend:"chl.grid.BaseGrid",store:"CustomerGridStoreId",actionBaseName:"CustomerGridAction",listeners:{itemclick:function(grid,record,hitem,index,e,opts){},itemdblclick:function(grid,record,hitem,index,e,opts){ActionBase.getAction("editCustomer").execute()},itemcontextmenu:function(view,rec,item,index,e,opts){e.stopEvent(),CustomerGrid_RightMenu.showAt(e.getXY())},beforeitemmousedown:function(view,record,item,index,e,options){},selectionchange:function(view,seles,op){seles[0]&&ActionBase.updateActions("CustomerGridAction",seles)}},columns:[],dockedItems:[{xtype:"toolbar",itemId:"toolbarID",dock:"top",layout:{overflowHandler:"Menu"},items:[ActionBase.getAction("refreshCustomer"),"-",ActionBase.getAction("searchCustomer"),ActionBase.getAction("addCustomer"),ActionBase.getAction("editCustomer"),"-",ActionBase.getAction("editCustomer_number"),ActionBase.getAction("addCustomerRent"),"->",{fieldLabel:"按客户名查找",text:"按客户名查找",width:300,labelAlign:"right",labelWidth:80,xtype:"searchfield",paramName:"customer_name",itemId:"CustomerGridSearchfieldId",listeners:{render:function(){var me=this;me.store=GridManager.CustomerGrid.getStore()}}}]},{xtype:"Pagingtoolbar",itemId:"pagingtoolbarID",store:"CustomerGridStoreId",dock:"bottom",items:[]}],initComponent:function(){var me=this;me.callParent(arguments),ActionBase.setTargetView(me.actionBaseName,me),ActionBase.updateActions(me.actionBaseName,me.getSelectionModel().getSelection())},loadGrid:function(isSearch){var me=this,store=me.getStore(),sessiontoken=store.getProxy().extraParams.sessiontoken;!sessiontoken||0==sessiontoken.length;var filter={};store.filterMap.each(function(key,value,length){filter[key]=value}),store.getProxy().extraParams.filter=Ext.JSON.encode(filter),store.getProxy().extraParams.refresh=1,store.loadPage(1),store.getProxy().extraParams.refresh=null,GlobalFun.SetGridTitle(me.up("#centerGridDisplayContainer"),store,"客户列表"),ActionBase.updateActions(me.actionBaseName,me.getSelectionModel().getSelection())}}),GridManager.CreateCustomerGrid=function(param){var tmpArr=[{text:"编号",dataIndex:"customer_id",renderer:GlobalFun.UpdateRecord,width:100},{text:"客户名",dataIndex:"customer_name",renderer:GlobalFun.UpdateRecord,width:100},{text:"手机号",dataIndex:"mobile",renderer:GlobalFun.UpdateRecord,width:100},{text:"房租单价",dataIndex:"rent_area",renderer:GlobalFun.UpdateRecord,width:100,groupable:!1,sortable:!1},{text:"面积单量比",dataIndex:"area_to_order_number",renderer:GlobalFun.UpdateRecord,width:100,groupable:!1,sortable:!1},{text:"房租单价",dataIndex:"rent_pre_price",renderer:GlobalFun.UpdateRecord,width:100,groupable:!1,sortable:!1},{text:"开始日期",dataIndex:"date_start",renderer:GlobalFun.UpdateRecord,width:100,groupable:!1,sortable:!1},{text:"结束日期",dataIndex:"date_end",renderer:GlobalFun.UpdateRecord,width:100,groupable:!1,sortable:!1}];return GridManager.CustomerGrid=Ext.create("chl.gird.CustomerGrid",GridManager.BaseGridCfg("CustomerGrid","CustomerGridState",tmpArr)),param&&param.needLoad&&GridManager.CustomerGrid.loadGrid(),GridManager.CustomerGrid},GridManager.SetCustomerGridSelectionChangeEvent=function(param){GridManager.CustomerGrid.on("selectionchange",function(view,seles,op){!seles[0]})},Ext.define("chl.Grid.AddUpdateCustomerWin",{extend:"Ext.window.Window",title:"添加",defaultFocus:"customer_nameItemId",iconCls:"",record:!1,height:120,width:830,layout:"vbox",modal:!0,resizable:!1,items:[{xtype:"form",itemId:"formId",autoScroll:!0,height:450,width:810,border:!1,bodyPadding:15,defaultType:"textfield",layout:{type:"table",columns:2},defaults:{labelAlign:"right",labelPad:15,width:340,labelWidth:125,maxLength:100,maxLengthText:"最大长度为100"},items:[{name:"customer_name",fieldLabel:"客户名",itemId:"customer_nameItemId",validateOnBlur:!1,allowBlank:!1,blankText:"不能为空"},{name:"mobile",fieldLabel:"手机号",itemId:"mobileItemId",validateOnBlur:!1,allowBlank:!1,blankText:"不能为空"}]}],buttons:[{text:"重置",handler:function(){var me=this,w=me.up("window"),f=w.down("#formId");if(f.getForm().reset(),"update"==w.action){var sm=w.grid.getSelectionModel();sm.hasSelection()&&f.getForm().loadRecord(sm.getSelection()[0])}}},{text:"确定",itemId:"submit",handler:function(){var me=this,w=me.up("window"),form=w.down("#formId").getForm();if(form.isValid()){var url="create"==w.action?GlobalConfig.Controllers.CustomerGrid.addCustomer:GlobalConfig.Controllers.CustomerGrid.updateCustomer;form.submit({url:url,params:{req:"dataset",dataname:"AddUpdateCustomer",restype:"json",customer_id:w.record?w.record.data.customer_id:0,Id:w.record?w.record.data.ControllTid:0,logId:w.record?w.record.data.Id:0,action:w.action,sessiontoken:GlobalFun.getSeesionToken()},success:function(form,action){w.grid.loadGrid(),w.close()},failure:function(form,action){GlobalFun.errorProcess(action.result.code)||Ext.Msg.alert("失败",action.result.msg)}})}}},{text:"取消",handler:function(){var me=this;me.up("window").close()}}]}),Ext.define("chl.Grid.AddUpdateCustomerRentWin",{extend:"Ext.window.Window",title:"添加",defaultFocus:"customer_nameItemId",iconCls:"",record:!1,height:650,width:830,layout:"vbox",modal:!0,resizable:!1,bodyPadding:5,items:[{xtype:"form",itemId:"formId",autoScroll:!0,height:170,width:810,border:!1,bodyPadding:5,defaultType:"textfield",layout:{type:"table",columns:2},defaults:{labelAlign:"right",labelPad:15,width:340,labelWidth:125,maxLength:100},items:[{name:"customer_name",xtype:"displayfield",fieldLabel:"客户名",itemId:"customer_nameItemId",validateOnBlur:!1,allowBlank:!1,blankText:"不能为空"},{name:"mobile",fieldLabel:"手机号",xtype:"displayfield",itemId:"mobileItemId",validateOnBlur:!1,allowBlank:!1,blankText:"不能为空"},{name:"rent_area",fieldLabel:"租贷面积（平米）",itemId:"rent_areaItemId",validateOnBlur:!1,allowBlank:!1,blankText:"不能为空",regex:GlobalConfig.RegexController.regexNumber,regexText:"请输入数字",maxLength:6},{name:"area_to_order_number",fieldLabel:"面积单量比",itemId:"area_to_order_numberItemId",validateOnBlur:!1,allowBlank:!1,blankText:"不能为空",regex:GlobalConfig.RegexController.regexMoney2Fixed,regexText:"请输入数字"},{name:"rent_pre_price",fieldLabel:"房租单价",validateOnBlur:!1,colspan:2,allowBlank:!1,blankText:"不能为空",regex:GlobalConfig.RegexController.regexMoney2Fixed,regexText:"请输入数字"},{xtype:"datefield",name:"date_start",format:"Y-m-d",fieldLabel:"开始时间",allowBlank:!1,blankText:"不能为空",itemId:"date_start",vtype:"daterange",endDateField:"date_end"},{xtype:"datefield",name:"date_end",format:"Y-m-d",fieldLabel:"结束时间",allowBlank:!1,blankText:"不能为空",itemId:"date_end",vtype:"daterange",startDateField:"date_start"},{xtype:"button",colspan:2,width:100,margin:"0 0 0 600",text:"添加",handler:function(com){var me=this,w=me.up("window"),form=w.down("#formId").getForm();if(form.isValid()){var url=GlobalConfig.Controllers.CustomerGrid.addCustomerRent;form.submit({url:url,params:{req:"dataset",dataname:"addCustomerRent",restype:"json",customerId:w.cid,action:w.action,sessiontoken:GlobalFun.getSeesionToken()},success:function(form,action){w.down("CustomerRentGrid").loadGrid()},failure:function(form,action){GlobalFun.errorProcess(action.result.code)||Ext.Msg.alert("失败",action.result.msg)}})}}},{name:"customer_id",xtype:"hidden"}]},{xtype:"CustomerRentGrid",margin:"5 0 0 0",width:810,height:400}],buttons:[{text:"关闭",handler:function(){var me=this;me.up("window").close()}}],listeners:{beforehide:function(com){WindowManager.AddUpdateCustomerRentWin.grid.store.load({scope:this,callback:function(records,operation,success){var record=WindowManager.AddUpdateCustomerRentWin.record;Ext.Array.each(records,function(item,index){return record.data.customer_id==item.data.customer_id?(record=item,!1):void 0});var sm=WindowManager.AddUpdateCustomerRentWin.grid.getSelectionModel();sm.select(record)}})}}});
//# sourceMappingURL=CustomerGrid.js.map
Ext.define("chl.Action.Tracking_numberGridAction",{extend:"WS.action.Base",category:"Tracking_numberGridAction"}),Ext.create("chl.Action.Tracking_numberGridAction",{itemId:"searchTracking_number",iconCls:"search",tooltip:"查询",text:"查询",handler:function(){var target=this.getTargetView();ActionManager.searchTracking_number(target)},updateStatus:function(selection){}}),Ext.create("chl.Action.Tracking_numberGridAction",{itemId:"importTracking_number",iconCls:"import",tooltip:"导入",text:"导入",handler:function(){var target=this.getTargetView(),win=Ext.create("Ext.window.Window",{height:360,width:800,modal:!0,resizable:!1,iconCls:"import",title:"上传文件",bodyPadding:15,defaults:{margin:"0 0 20 0"},items:[{xtype:"form",itemId:"formId",bodyPadding:15,items:[{xtype:"filefield",name:"fileUpload",fieldLabel:"请选择导入的文件",width:600,labelWidth:150,labelAlign:"right",blankText:"请选择导入的文件",msgTarget:"side",itemId:"fileupId",buttonConfig:{iconCls:"import",width:100},buttonText:"添加文件",listeners:{change:function(com){var me=com,supType=new Array("xls","xlsx"),fNmae=me.getValue(),fType=fNmae.substring(fNmae.lastIndexOf(".")+1,fNmae.length).toLowerCase(),returnFlag=!0;if(Ext.Array.each(supType,function(rec){return rec==fType?(returnFlag=!1,!1):void 0}),returnFlag)return void Ext.Msg.alert("添加文件","不支持的文件格式！");var f=me.up("form"),form=(me.up("window"),f.getForm()),urlStr=GlobalConfig.Controllers.Tracking_numberGrid.uploadExcel+"?req=call&callname=uploadExcel&sessiontoken="+GlobalFun.getSeesionToken();form.submit({timeout:600,url:urlStr,waitMsg:"正在上传...",waitTitle:"等待文件上传,请稍候...",success:function(fp,action){action.result.data;target.loadGrid()},failure:function(fp,action){GlobalFun.errorProcess(action.result.code)||ActionManager.showUpLoadExcelError(action.result.data)}})}}}]},{xtype:"form",itemId:"h5formId",layout:"vbox",bodyPadding:15,items:[{xtype:"label",style:{"font-weight":"bold"},text:"如果您使用的是高级的支持Html5的浏览器，请使用的这里的上传"},{xtype:"label",style:{color:"red","font-weight":"bold"},text:"多文件批量，更快捷，可拖拽文件，可视化的真实上传进度显示,更大的文件"},{xtype:"Html5FileUpload",name:"fileUpload",labelAlign:"right",fieldLabel:"请选择导入的文件<br/>(可拖拽文件到此处)",width:600,height:100,style:{border:"1px solid green"},buttonOnly:!0,labelWidth:150,msgTarget:"side",itemId:"fileupId",buttonConfig:{iconCls:"import",width:300},uploadUrl:GlobalConfig.Controllers.Tracking_numberGrid.uploadExcel+"?req=call&callname=uploadExcel&sessiontoken="+GlobalFun.getSeesionToken(),accept:".xls*",buttonText:"添加文件",listeners:{change:function(com){var me=com;if(Ext.isIE)return void Ext.Msg.alert("消息","您的浏览器不支持Html5上传,请更换浏览器或升级版本。");var supType=new Array("xls","xlsx"),fNmae=me.getValue(),fType=fNmae.substring(fNmae.lastIndexOf(".")+1,fNmae.length).toLowerCase(),returnFlag=!0;return Ext.Array.each(supType,function(rec){return rec==fType?(returnFlag=!1,!1):void 0}),returnFlag?void Ext.Msg.alert("添加文件","不支持的文件格式！"):void me.sendFiles(me.fileInputEl.dom.files)}}}]}],buttons:[{text:"关闭",handler:function(){win.close()}}]});win.show()},updateStatus:function(selection){}}),Ext.create("chl.Action.Tracking_numberGridAction",{itemId:"exportTracking_number",iconCls:"export",tooltip:"导出",text:"导出",handler:function(){var target=this.getTargetView(),store=target.getStore(),extraParams=store.getProxy().extraParams,param={downType:"Tracking_number",dir:"ASC",sort:"tracking_number",filter:extraParams.filter,sessiontoken:GlobalFun.getSeesionToken()};WsCall.downloadFile(GlobalConfig.Controllers.Tracking_numberGrid.outPutExcel,"download",param)},updateStatus:function(selection){}}),Ext.create("chl.Action.Tracking_numberGridAction",{itemId:"refreshTracking_number",iconCls:"refresh",tooltip:"刷新",text:"刷新",handler:function(){var target=this.getTargetView();ActionManager.refreshTracking_number(target)},updateStatus:function(selection){}}),ActionManager.refreshTracking_number=function(traget){traget.loadGrid()},ActionManager.showUpLoadExcelError=function(data){var html="";Ext.Array.each(data,function(item,index){html+=item.msg+"<br>"}),Ext.create("Ext.window.Window",{title:"数据格式错误",modal:!0,width:700,height:600,bodyPadding:15,layout:{type:"table",columns:2},items:[{xtype:"container",cls:"x-message-box-error ",height:34,width:34},{xtype:"label",text:"数据格式错误，请修改下列数据后重新上传"},{xtype:"container",margin:"15 0 0 0",colspan:2,autoScroll:!0,height:470,width:660,name:"message",html:html}],buttons:[{text:"确定",handler:function(com){com.up("window").close()}}]}).show()},ActionManager.searchTracking_number=function(traget){WindowManager.Tracking_numberWin&&""!=WindowManager.Tracking_numberWin?WindowManager.Tracking_numberWin.show():WindowManager.Tracking_numberWin=Ext.create("Ext.window.Window",{modal:!0,resizable:!1,closeAction:"hide",title:"查询",defaultFocus:"tracking_number",iconCls:"search",record:!1,height:300,width:500,layout:"vbox",items:[{xtype:"form",itemId:"formId",autoScroll:!0,height:290,width:500,border:!1,bodyPadding:15,defaultType:"textfield",layout:{type:"table",columns:1},defaults:{labelAlign:"right",labelPad:15,width:340,labelWidth:125,maxLength:100},items:[{fieldLabel:"票据号",itemId:"tracking_number",maxLength:64},{fieldLabel:"网点",itemId:"arrive_express_point_name",maxLength:64},{fieldLabel:"网点代码",itemId:"arrive_express_point_code",maxLength:16},{xtype:"fieldcontainer",colspan:2,width:490,fieldLabel:"收货时间",defaultType:"datetimefield",layout:{type:"hbox"},defaults:{labelAlign:"right",width:100},items:[{xtype:"datefield",format:"Y-m-d",itemId:"dateStar",vtype:"daterange",endDateField:"dateEnd",editable:!1},{xtype:"label",margin:"0 0 0 5",width:20,text:"至"},{xtype:"datefield",format:"Y-m-d",itemId:"dateEnd",vtype:"daterange",startDateField:"dateStar",editable:!1}]}]}],buttons:[{text:"重置",handler:function(){var me=this,w=me.up("window"),f=w.down("#formId");f.getForm().reset()}},{text:"确定",itemId:"submit",handler:function(){var me=this,win=me.up("window"),searchFlag=!1,store=traget.getStore(),extraParams=store.getProxy().extraParams,dateStarField=win.down("#dateStar"),dateEndField=win.down("#dateEnd"),dateStar=dateStarField.getValue(),dateEnd=dateEndField.getValue();GlobalFun.ValidDateStartEnd(dateStarField,dateEndField);var form=win.down("#formId").getForm();if(form.isValid()){var tracking_number=win.down("#tracking_number").getValue();""!=tracking_number?(GlobalFun.GridSearchInitFun("tracking_number",!1,store,tracking_number),searchFlag=!0):GlobalFun.GridSearchInitFun("customer_name",!0,store,!1);var arrive_express_point_name=win.down("#arrive_express_point_name").getValue();""!=arrive_express_point_name?(GlobalFun.GridSearchInitFun("arrive_express_point_name",!1,store,arrive_express_point),searchFlag=!0):GlobalFun.GridSearchInitFun("arrive_express_point_name",!0,store,!1),dateStar&&dateEnd?(extraParams.DateFilter=!0,extraParams.arrive_time=Ext.Date.format(dateStar,"Y-m-d")+","+Ext.Date.format(dateEnd,"Y-m-d"),searchFlag=!0):(extraParams.DateFilter=!1,extraParams.arrive_time=""),searchFlag?(win.close(),traget.loadGrid(!0)):(win.close(),traget.loadGrid())}}},{text:"取消",handler:function(){var me=this;me.up("window").close()}}]}).show()};
//# sourceMappingURL=Tracking_numberGridAction.js.map
Ext.define("chl.Model.Tracking_numberGridModel",{extend:"Ext.data.Model",idProperty:"Id",alternateClassName:["Tracking_numberGridModel"],fields:[{name:"tracking_number_id",type:"string"},{name:"tracking_number",type:"string"},{name:"weight",type:"string"},{name:"arrive_express_point_name",type:"string"},{name:"arrive_express_point_code",type:"string"},{name:"arrive_time",type:"string"},{name:"income",type:"string"},{name:"cost",type:"string"},{name:"customer_id",type:"string"},{name:"customer_name",type:"string"},{name:"admin_id",type:"string"},{name:"admin_name",type:"string"},{name:"account_status",type:"string"},{name:"account_status_name",type:"string"},{name:"customer_rent_id",type:"string"},{name:"express_id"},{name:"express_name"}]});
//# sourceMappingURL=Tracking_numberGridModel.js.map
Ext.create("Ext.data.Store",{model:"chl.Model.Tracking_numberGridModel",storeId:"Tracking_numberGridStoreId",filterMap:Ext.create("Ext.util.HashMap"),pageSize:GlobalConfig.GridPageSize,autoLoad:!1,remoteSort:!0,sorters:[{property:"tracking_number_id",direction:"DESC"}],autoSync:!1,proxy:{type:"ajax",api:GlobalConfig.Controllers.Tracking_numberGrid,filterParam:"filter",sortParam:"sort",directionParam:"dir",limitParam:"limit",startParam:"start",simpleSortMode:!0,extraParams:{req:"data",dataname:"traking_number",restype:"json",sessiontoken:GlobalFun.getSeesionToken(),folderid:-1,refresh:null,template:""},reader:{type:"json",root:"data",seccessProperty:"success",messageProperty:"msg",totalProperty:"total"},writer:{type:"json",writeAllFields:!1,allowSingle:!1},actionMethods:{create:"POST",read:"POST",update:"POST",destroy:"POST"},listeners:{exception:function(proxy,response,operation){var json=Ext.JSON.decode(response.responseText),code=json.code;GlobalFun.errorProcess(code),"read"!=operation.action}}},listeners:{load:function(store,records,suc,operation,opts){store.getTotalCount();suc||store.loadData([])}}});
//# sourceMappingURL=Tracking_numberGridStore.js.map
var Tracking_numberGrid_RightMenu=Ext.create("Ext.menu.Menu",{items:[ActionBase.getAction("refreshTracking_number"),"-",ActionBase.getAction("searchTracking_number"),"-",ActionBase.getAction("importTracking_number"),ActionBase.getAction("exportTracking_number")]});Ext.define("chl.gird.Tracking_numberGrid",{alternateClassName:["Tracking_numberGrid"],alias:"widget.Tracking_numberGrid",extend:"chl.grid.BaseGrid",store:"Tracking_numberGridStoreId",actionBaseName:"Tracking_numberGridAction",listeners:{itemclick:function(grid,record,hitem,index,e,opts){},itemdblclick:function(grid,record,hitem,index,e,opts){},itemcontextmenu:function(view,rec,item,index,e,opts){e.stopEvent(),Tracking_numberGrid_RightMenu.showAt(e.getXY())},beforeitemmousedown:function(view,record,item,index,e,options){},selectionchange:function(view,seles,op){seles[0]&&ActionBase.updateActions("Tracking_numberGridAction",seles)}},columns:[],dockedItems:[{xtype:"toolbar",itemId:"toolbarID",dock:"top",layout:{overflowHandler:"Menu"},items:[ActionBase.getAction("refreshTracking_number"),"-",ActionBase.getAction("searchTracking_number"),"-",ActionBase.getAction("importTracking_number"),ActionBase.getAction("exportTracking_number")]},{xtype:"Pagingtoolbar",itemId:"pagingtoolbarID",store:"Tracking_numberGridStoreId",dock:"bottom",items:[{xtype:"tbtext",text:"过滤:"},{xtype:"GridFilterMenuButton",itemId:"menuID",text:"全部状态",filterParam:{group:"account_statusGroup",text:"全部类别",filterKey:"account_status",GridTypeName:"Tracking_numberGrid",store:StoreManager.ComboStore.Tracking_numberGridTypeStore}},"-",{xtype:"GridSelectCancelMenuButton",itemId:"selectRecId",text:"选择",targetName:"Tracking_numberGrid"}]}],initComponent:function(){var me=this;me.callParent(arguments),ActionBase.setTargetView(me.actionBaseName,me),ActionBase.updateActions(me.actionBaseName,me.getSelectionModel().getSelection())},loadGrid:function(isSearch){var me=this,store=me.getStore(),sessiontoken=store.getProxy().extraParams.sessiontoken;!sessiontoken||0==sessiontoken.length;var filter={};store.filterMap.each(function(key,value,length){filter[key]=value}),store.getProxy().extraParams.filter=Ext.JSON.encode(filter),store.getProxy().extraParams.refresh=1,store.loadPage(1),store.getProxy().extraParams.refresh=null,GlobalFun.SetGridTitle(me.up("#centerGridDisplayContainer"),store,"票据列表"),ActionBase.updateActions(me.actionBaseName,me.getSelectionModel().getSelection())}}),GridManager.CreateTracking_numberGrid=function(param){var tmpArr=[{text:"编号",dataIndex:"tracking_number_id",renderer:GlobalFun.UpdateRecord,flex:1},{text:"票据号",dataIndex:"tracking_number",renderer:GlobalFun.UpdateRecord,flex:1},{text:"重量",dataIndex:"weight",renderer:GlobalFun.UpdateRecord,flex:1},{text:"网点",dataIndex:"arrive_express_point_name",renderer:GlobalFun.UpdateRecord,flex:1},{text:"网点代码",dataIndex:"arrive_express_point_code",renderer:GlobalFun.UpdateRecord,flex:1},{text:"收货时间",dataIndex:"arrive_time",renderer:GlobalFun.UpdateRecord,flex:1},{text:"收入",dataIndex:"income",renderer:GlobalFun.UpdateRecord,flex:1},{text:"成本",dataIndex:"cost",renderer:GlobalFun.UpdateRecord,flex:1},{text:"客户名称",dataIndex:"customer_name",renderer:GlobalFun.UpdateRecord,flex:1},{text:"操作人",dataIndex:"admin_name",renderer:GlobalFun.UpdateRecord,flex:1},{text:"结算状态",dataIndex:"account_status_name",renderer:GlobalFun.UpdateRecord,flex:1},{text:"快递公司",dataIndex:"express_name",renderer:GlobalFun.UpdateRecord,flex:1}];return GridManager.Tracking_numberGrid=Ext.create("chl.gird.Tracking_numberGrid",GridManager.BaseGridCfg("Tracking_numberGrid","Tracking_numberGridState",tmpArr)),param&&param.needLoad&&GridManager.Tracking_numberGrid.loadGrid(),GridManager.Tracking_numberGrid},GridManager.SetTracking_numberGridSelectionChangeEvent=function(param){GridManager.Tracking_numberGrid.on("selectionchange",function(view,seles,op){!seles[0]})};
//# sourceMappingURL=Tracking_numberGrid.js.map
Ext.define("chl.panel.ExpressPanel",{alternateClassName:["ExpressPanel"],alias:"widget.ExpressPanel",extend:"Ext.panel.Panel",itemId:"ExpressPanel"}),GridManager.CreateExpressPanel=function(){var items=[];for(key in GlobalConfig.Province)items.push({title:GlobalConfig.Province[key],code:key,layout:"hbox",items:[{xtype:"label",text:"现有规则:0",itemId:"lbl"+key},{xtype:"button",text:"添加规则",margin:"0 0 0 20",width:100,iconCls:"btnAdd",myval:key,handler:function(com){var sel=TreeManager.MainItemListTree.getSelectionModel().getSelection()[0],param={express_id:sel.data.express_id,province_code:com.myval,sessiontoken:GlobalFun.getSeesionToken()};WsCall.call(GlobalConfig.Controllers.ExpressPanel.GetExpressRule,"GetExpressRule",param,function(response,opts){function createRuleRow(rowData){var tempRuleItems=[];return Ext.Array.each(rowData,function(item,index,alls){var obj={},title="";title="1"==item.price_type?"固定价格":"称重价格",obj={xtype:"fieldset",title:title,width:770,collapsible:!0,layout:{type:"table",columns:2},defaults:{xtype:"displayfield",labelAlign:"right",labelPad:15,width:340,labelWidth:125,maxLength:100,maxLengthText:"最大长度为100"},items:[{fieldLabel:"起始重量(kg)",value:item.weight_min},{fieldLabel:"结束重量(kg)",value:item.weight_max},{fieldLabel:"价格",value:item.price},{fieldLabel:"排序",value:item.sort_order},{xtype:"button",colspan:2,rule_id:item.rule_id,width:100,margin:"0 0 0 630",text:"删除",handler:function(com){var rule_id=com.rule_id,param={rule_id:rule_id,sessiontoken:GlobalFun.getSeesionToken()};WsCall.call(GlobalConfig.Controllers.ExpressPanel.delExpressRule,"delExpressRule",param,function(response,opts){com.up("fieldset").destroy()},function(response,opts){GlobalFun.errorProcess(response.code)||Ext.Msg.alert("失败",response.msg)},!0,!1,com.up("window").getEl())}}]},tempRuleItems.push(obj)}),tempRuleItems}var data=response.data;Ext.create("Ext.window.Window",{title:"添加规则("+GlobalConfig.Province[com.myval]+")",pid:com.myval,width:820,height:700,iconCls:"editCustomerRule",resizable:!1,action:"create",modal:!0,autoScroll:!0,layout:"vbox",bodyPadding:10,dockedItems:[{xtype:"container",dock:"top",border:!1,bodyPadding:15,layout:{type:"table",columns:2},defaultType:"textfield",defaults:{labelAlign:"right",labelPad:15,width:340,labelWidth:125,maxLength:100},items:[{xtype:"form",itemId:"price_type0",height:140,width:810,bodyPadding:15,layout:{type:"table",columns:2},defaults:{labelAlign:"right",labelPad:15,width:340,labelWidth:125,maxLength:100,maxLengthText:"最大长度为100"},items:[{xtype:"fieldcontainer",colspan:2,fieldLabel:"价格类型",defaultType:"radiofield",layout:"hbox",defaults:{flex:1},items:[{boxLabel:"固定价格",checked:!0,name:"price_type",inputValue:"1"},{boxLabel:"称重价格",name:"price_type",inputValue:"2"}]},{xtype:"numberfield",name:"weight_min",fieldLabel:"起始重量(kg)",minValue:0,value:0,decimalPrecision:3,maxValue:GlobalConfig.MaxLimit,allowBlank:!1,blankText:"不能为空"},{xtype:"numberfield",name:"weight_max",fieldLabel:"结束重量(kg)",minValue:0,value:1,maxValue:GlobalConfig.MaxLimit,decimalPrecision:3,allowBlank:!1,blankText:"不能为空"},{xtype:"numberfield",name:"price",fieldLabel:"价格",decimalPrecision:2,minValue:0,maxValue:GlobalConfig.MaxLimit,regex:GlobalConfig.RegexController.regexMoney2Fixed,regexText:"请填写两位小数的数字",allowBlank:!1,blankText:"不能为空"},{fieldLabel:"排序",xtype:"numberfield",name:"sort_order",decimalPrecision:0,minValue:1,value:1},{xtype:"button",itemId:"btn_add",colspan:2,margin:"0 0 0 580",width:100,text:"添加",handler:function(com){var me=this,w=me.up("window"),form=w.down("#price_type0").getForm();if(form.isValid()){var url=GlobalConfig.Controllers.ExpressPanel.addExpressRule;form.submit({url:url,params:{req:"dataset",dataname:"addCustomerRule",restype:"json",price_type:0,express_id:sel.data.express_id,province_code:w.pid,action:w.action,sessiontoken:GlobalFun.getSeesionToken()},success:function(form,action){var data=action.result.data,arr=createRuleRow(data);w.removeAll(),w.add(arr)},failure:function(form,action){GlobalFun.errorProcess(action.result.code)||Ext.Msg.alert("失败",action.result.msg)}})}}}]}]}],items:[],listeners:{boxready:function(com){var tempRuleItems=createRuleRow(data);com.add(tempRuleItems)},beforehide:function(com){var param={express_id:sel.data.express_id,sessiontoken:GlobalFun.getSeesionToken()};WsCall.call(GlobalConfig.Controllers.ExpressPanel.GetCustomer_numberCount,"GetCustomer_numberCount",param,function(response,opts){var data=response.data;Ext.Array.each(data,function(item,index,alls){var temp=GridManager.ExpressPanel.down("#lbl"+item.province_code);temp.setText("现有规则:"+item.count)})},function(response,opts){GlobalFun.errorProcess(response.code)||Ext.Msg.alert("失败",response.msg)},!1)}},buttons:[{text:"退出",handler:function(){var me=this;me.up("window").close()}}]}).show()},function(response,opts){GlobalFun.errorProcess(response.code)||Ext.Msg.alert("失败",response.msg)},!0)}}]});return GridManager.ExpressPanel=Ext.create("chl.panel.ExpressPanel",{bodyPadding:15,autoScroll:!0,layout:{type:"table",columns:2},defaults:{xtype:"fieldset",width:400,margin:"10 10 10 10"},items:items}),GridManager.ExpressPanel};
//# sourceMappingURL=ExpressPanel.js.map
Ext.define("chl.panel.CompanyPanel",{alternateClassName:["CompanyPanel"],alias:"widget.CompanyPanel",extend:"Ext.panel.Panel",itemId:"CompanyPanel"}),GridManager.CreateCompanyPanel=function(){return GridManager.CompanyPanel=Ext.create("chl.panel.CompanyPanel",{bodyPadding:15,defaults:{xtype:"button",width:100,margin:"10 10 10 10"},items:[{text:"圆通快递",myval:"0031",id:"0031",handler:function(com){var node=TreeManager.MainItemListTree.getStore().getNodeById(com.myval),parentNode=node.parentNode;parentNode.isExpanded()?TreeManager.MainItemListTree.getSelectionModel().select(node,!0):parentNode.expand(!1,function(){TreeManager.MainItemListTree.getSelectionModel().select(node,!0)})}}]}),GridManager.CompanyPanel};
//# sourceMappingURL=CompanyPanel.js.map
Ext.onReady(function(){Ext.getBody().mask("正在加载..."),GlobalFun.fixedBugs(),Ext.state.Manager.setProvider(Ext.create("Ext.state.CookieProvider",{expires:new Date((new Date).getTime()+2592e6)})),Ext.tip.QuickTipManager.init();var LoadCurrUserInfo=function(callBack){var param={sessiontoken:GlobalFun.getSeesionToken()};WsCall.pcall(GlobalConfig.Controllers.User.GetCurrUserInfo,"GetCurrUserInfo",param,function(response,opts){GlobalConfig.CurrUserInfo=response.data[0],callBack()},function(response,opts){GlobalFun.errorProcess(response.code)||Ext.Msg.alert("登录失败",response.msg)},!1)},LoadMainView=function(){if(""==GlobalConfig.CurrUserInfo)return void Ext.Msg.alert("登录失败","登录失败！无效的登录信息",function(){GlobalFun.ReDirectUrl("login.html")});GridManager.ManageDfGrid=Ext.create("chl.dfgrid.ManageDfGrid");var roleArr=[["001","客户管理"],["002","yy管理"]];GridManager.ManageDfGrid.getStore().loadData(roleArr),GridManager.CreateCustomerGrid({needLoad:!1}),GridManager.SetCustomerGridSelectionChangeEvent(),GridManager.CreateTracking_numberGrid({needLoad:!1}),GridManager.SetTracking_numberGridSelectionChangeEvent(),GridManager.CreateExpressPanel(),GridManager.CreateCompanyPanel(),TreeManager.CreateMainItemListTree({needLoad:!1}),TreeManager.SetMainItemListTreeSelectionChangeEvent(),GlobalConfig.ViewPort=Ext.create("Ext.container.Viewport",{layout:{type:"border"},defaults:{split:!0,collapsible:!0},items:[{region:"north",title:"公告栏",stateful:!1,collapsed:!0,height:100,items:[{xtype:"container",html:"暂无公告"}]},{region:"west",stateId:"westStateId",stateful:!0,iconCls:"home",preventHeader:!0,title:"管理菜单",layout:{type:"accordion",animate:!1,activeOnTop:!1,collapseFirst:!1,titleCollapse:!0},width:200,listeners:{boxready:function(com,width,height,opts){var treeArr=[];treeArr.push(TreeManager.MainItemListTree),com.add(treeArr)}},items:[]},{region:"center",stateId:"centerStateId",stateful:!0,collapsible:!1,layout:{type:"border"},defaults:{split:!0,collapsible:!0,border:!1},items:[{region:"center",stateId:"centercenterStateId",stateful:!0,collapsible:!1,itemId:"centerGridDisplayContainer",title:"信息",layout:"card",height:400,listeners:{boxready:function(com,width,height,opts){var gridArr=[];gridArr.push(GridManager.ManageDfGrid),gridArr.push(GridManager.CustomerGrid),gridArr.push(GridManager.Tracking_numberGrid),gridArr.push(GridManager.ExpressPanel),gridArr.push(GridManager.CompanyPanel),com.add(gridArr)}},items:[]},{region:"south",stateId:"centersouthStateId",itemId:"centerGridDetailContainer",stateful:!0,preventHeader:!0,height:200,collapsed:!0,bodyBoder:!1,xtype:"tabpanel",frame:!1,border:!1,defaults:{border:!1},items:[{title:"详细信息",layout:"auto",itemId:"southTab1",autoScroll:!0,items:[{xtype:"container",width:800,html:"留待开发..."}]},{title:"介绍",autoScroll:!0,itemId:"southTab2",padding:"5px 5px 5px 20px",items:[{xtype:"container",width:800,html:"留待开发..."}]}]}]},{region:"south",stateId:"southStateId",stateful:!1,height:30,xtype:"toolbar",split:!1,collapsible:!1,items:["->","-",{xtype:"button",width:80,iconCls:"logout",text:"退出登录",tooltip:"退出登录当前用户",handler:function(){GlobalConfig.newMessageBox.confirm("退出登录","确定要退出登录当前用户吗?",function(btn){if("yes"==btn){var param={};WsCall.call(GlobalConfig.Controllers.User.UserLoginOut,"UserLoginOut",param,function(response,opts){Ext.util.Cookies.clear("login_sessiontoken"),Ext.getBody().mask("请稍候..."),(new Ext.util.DelayedTask).delay(20,function(){GlobalFun.ReDirectUrl("login.html")})},function(response,opts){GlobalFun.errorProcess(response.code)||Ext.Msg.alert("注销失败",response.msg)},!1)}})}}]}]})},ComboSucCount=0,ComboSucTotal=1,combInitCallBack=function(records,operation,success){success&&(ComboSucCount++,ComboSucCount==ComboSucTotal&&LoadCurrUserInfo(function(){LoadMainView(),GlobalFun.Heartbeat(),(new Ext.util.DelayedTask).delay(200,function(){Ext.getBody().unmask()})}))},LoadBaseEnumStore=function(){combInitCallBack(null,null,!0)};LoadBaseEnumStore(),GlobalFun.JsonToArray(GlobalConfig.Province)});
//# sourceMappingURL=index.js.map