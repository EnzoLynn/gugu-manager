var Express_pointGrid_RightMenu=Ext.create("Ext.menu.Menu",{items:[ActionBase.getAction("refreshExpress_point"),"-",ActionBase.getAction("searchExpress_point"),ActionBase.getAction("addExpress_point"),ActionBase.getAction("editExpress_point"),ActionBase.getAction("delExpress_point")]});Ext.define("chl.gird.Express_pointGrid",{alternateClassName:["Express_pointGrid"],alias:"widget.Express_pointGrid",extend:"chl.grid.BaseGrid",store:"Express_pointGridStoreId",actionBaseName:"Express_pointGridAction",listeners:{itemclick:function(grid,record,hitem,index,e,opts){},itemdblclick:function(grid,record,hitem,index,e,opts){ActionBase.getAction("editExpress_point").execute()},itemcontextmenu:function(view,rec,item,index,e,opts){e.stopEvent(),Express_pointGrid_RightMenu.showAt(e.getXY())},beforeitemmousedown:function(view,record,item,index,e,options){},selectionchange:function(view,seles,op){seles[0]&&ActionBase.updateActions("Express_pointGridAction",seles)}},columns:[],dockedItems:[{xtype:"toolbar",itemId:"toolbarID",dock:"top",layout:{overflowHandler:"Menu"},items:[ActionBase.getAction("refreshExpress_point"),"-",ActionBase.getAction("searchExpress_point"),ActionBase.getAction("addExpress_point"),ActionBase.getAction("editExpress_point"),ActionBase.getAction("delExpress_point"),"->",{fieldLabel:"按网点名查找",text:"按网点名查找",width:300,labelAlign:"right",labelWidth:80,xtype:"searchfield",paramName:"Express_point_name",itemId:"Express_pointGridSearchfieldId",listeners:{render:function(){var me=this;me.store=GridManager.Express_pointGrid.getStore()}}}]},{xtype:"Pagingtoolbar",itemId:"pagingtoolbarID",store:"Express_pointGridStoreId",dock:"bottom",items:[]}],initComponent:function(){var me=this;me.callParent(arguments),ActionBase.setTargetView(me.actionBaseName,me),ActionBase.updateActions(me.actionBaseName,me.getSelectionModel().getSelection())},loadGrid:function(isSearch){var me=this,store=me.getStore(),sessiontoken=store.getProxy().extraParams.sessiontoken;!sessiontoken||0==sessiontoken.length;var filter={};store.filterMap.each(function(key,value,length){filter[key]=value}),store.getProxy().extraParams.filter=Ext.JSON.encode(filter),store.getProxy().extraParams.refresh=1,store.loadPage(1),store.getProxy().extraParams.refresh=null,GlobalFun.SetGridTitle(me.up("#centerGridDisplayContainer"),store,"客户列表"),ActionBase.updateActions(me.actionBaseName,me.getSelectionModel().getSelection())}}),GridManager.CreateExpress_pointGrid=function(param){var tmpArr=[{text:"编号",dataIndex:"point_id",renderer:GlobalFun.UpdateRecord,width:100},{text:"网点名称",dataIndex:"express_point_name",renderer:GlobalFun.UpdateRecord,width:100},{text:"网点代码",dataIndex:"express_point_code",renderer:GlobalFun.UpdateRecord,width:100},{text:"省份代码",dataIndex:"province_code",renderer:GlobalFun.UpdateRecord,width:100,groupable:!1,sortable:!1},{text:"省份名称",dataIndex:"province_name",renderer:GlobalFun.UpdateRecord,width:100,groupable:!1,sortable:!1}];return GridManager.Express_pointGrid=Ext.create("chl.gird.Express_pointGrid",GridManager.BaseGridCfg("Express_pointGrid","Express_pointGridState",tmpArr)),param&&param.needLoad&&GridManager.Express_pointGrid.loadGrid(),GridManager.Express_pointGrid},GridManager.SetExpress_pointGridSelectionChangeEvent=function(param){GridManager.Express_pointGrid.on("selectionchange",function(view,seles,op){!seles[0]})},Ext.define("chl.Grid.AddUpdateExpress_pointWin",{extend:"Ext.window.Window",title:"添加",defaultFocus:"express_point_nameItemId",iconCls:"",record:!1,height:220,width:430,layout:"vbox",modal:!0,resizable:!1,items:[{xtype:"form",itemId:"formId",autoScroll:!0,height:250,width:420,border:!1,bodyPadding:15,defaultType:"textfield",layout:{type:"table",columns:1},defaults:{labelAlign:"right",labelPad:15,width:340,labelWidth:125,maxLength:100,enableKeyEvents:!0,listeners:{keydown:function(field,e,opts){var me=this;if(e.getKey()==e.ENTER){var win=me.up("window");win.down("#submit").fireHandler(e)}}}},items:[{name:"express_point_name",fieldLabel:"网点名称",validateOnBlur:!1,allowBlank:!1,blankText:"不能为空",maxLength:40},{name:"express_point_code",fieldLabel:"网点代码",validateOnBlur:!1,allowBlank:!1,blankText:"不能为空",maxLength:20},{xtype:"combobox",name:"province_code",fieldLabel:"省份",store:"ProvinceStoreId",queryMode:"local",displayField:"Name",valueField:"Id",editable:!1,allowBlank:!1,blankText:"不能为空",listeners:{boxready:function(com){com.up("window");GlobalFun.comboSelectFirstOrDefaultVal(com)}}}]}],buttons:[{text:"重置",handler:function(){var me=this,w=me.up("window"),f=w.down("#formId");if(f.getForm().reset(),"update"==w.action){var sm=w.grid.getSelectionModel();sm.hasSelection()&&f.getForm().loadRecord(sm.getSelection()[0])}}},{text:"确定",itemId:"submit",handler:function(){var me=this,w=me.up("window"),form=w.down("#formId").getForm();if(form.isValid()){var url="create"==w.action?GlobalConfig.Controllers.Express_pointGrid.create:GlobalConfig.Controllers.Express_pointGrid.update;form.submit({url:url,params:{req:"dataset",dataname:"AddUpdateExpress_point",restype:"json",point_id:w.record?w.record.data.point_id:0,action:w.action,sessiontoken:GlobalFun.getSeesionToken()},success:function(form,action){w.grid.loadGrid(),w.close()},failure:function(form,action){GlobalFun.errorProcess(action.result.code)||Ext.Msg.alert("失败",action.result.msg)}})}}},{text:"取消",handler:function(){var me=this;me.up("window").close()}}]});
//# sourceMappingURL=Express_pointGrid.js.map