var AttachFileGrid_RightMenu=Ext.create("Ext.menu.Menu",{items:[ActionBase.getAction("refreshAttachFile"),"-",ActionBase.getAction("searchAttachFile"),ActionBase.getAction("removeAttachFile"),ActionBase.getAction("uploadAttachFile"),"-",ActionBase.getAction("validateAttachFile"),ActionBase.getAction("importAttachFile"),ActionBase.getAction("dlErrorReportAttachFile")]});Ext.define("chl.gird.AttachFileGrid",{alternateClassName:["AttachFileGrid"],alias:"widget.AttachFileGrid",extend:"chl.grid.BaseGrid",store:"AttachFileGridStoreId",actionBaseName:"AttachFileGridAction",multiSelect:!0,listeners:{itemclick:function(grid,record,hitem,index,e,opts){},itemdblclick:function(grid,record,hitem,index,e,opts){},itemcontextmenu:function(view,rec,item,index,e,opts){e.stopEvent(),AttachFileGrid_RightMenu.showAt(e.getXY())},beforeitemmousedown:function(view,record,item,index,e,options){},selectionchange:function(view,seles,op){seles[0]&&ActionBase.updateActions("AttachFileGridAction",seles)}},columns:[],dockedItems:[{xtype:"toolbar",itemId:"toolbarID",dock:"top",layout:{overflowHandler:"Menu"},items:[ActionBase.getAction("refreshAttachFile"),"-",ActionBase.getAction("searchAttachFile"),ActionBase.getAction("removeAttachFile"),ActionBase.getAction("uploadAttachFile"),"-",ActionBase.getAction("validateAttachFile"),ActionBase.getAction("importAttachFile"),ActionBase.getAction("dlErrorReportAttachFile")]},{xtype:"Pagingtoolbar",itemId:"pagingtoolbarID",store:"AttachFileGridStoreId",dock:"bottom",items:[{xtype:"tbtext",text:"过滤:"},{xtype:"GridFilterMenuButton",itemId:"menuID",text:"全部验证状态",filterParam:{group:"validate_statusGroup",text:"全部验证状态",filterKey:"validate_status",GridTypeName:"AttachFileGrid",store:StoreManager.ComboStore.AttachFileGridValidate_statusStore}},{xtype:"GridFilterMenuButton",itemId:"import_statusmenuID",text:"全部导入状态",filterParam:{group:"import_statusGroup",text:"全部导入状态",filterKey:"import_status",GridTypeName:"AttachFileGrid",store:StoreManager.ComboStore.AttachFileGridImport_statusStore}},"-",{xtype:"GridSelectCancelMenuButton",itemId:"selectRecId",text:"选择",targetName:"AttachFileGrid"}]}],initComponent:function(){var me=this;me.callParent(arguments),ActionBase.setTargetView(me.actionBaseName,me),ActionBase.updateActions(me.actionBaseName,me.getSelectionModel().getSelection())},loadGrid:function(clearFilter,noPageOne){var me=this,store=me.getStore(),sessiontoken=store.getProxy().extraParams.sessiontoken;!sessiontoken||0==sessiontoken.length;var filter={};store.filterMap.each(function(key,value,length){filter[key]=value}),store.getProxy().extraParams.filter=Ext.JSON.encode(filter),store.getProxy().extraParams.refresh=1,noPageOne?store.load():store.loadPage(1),store.getProxy().extraParams.refresh=null,GlobalFun.SetGridTitle(me.up("#centerGridDisplayContainer"),store,"票据列表"),ActionBase.updateActions(me.actionBaseName,me.getSelectionModel().getSelection())}}),GridManager.AttachFileGridSerachfor_file_id=function(fileid){var node=TreeManager.MainItemListTree.getStore().getNodeById("002");TreeManager.MainItemListTree.getSelectionModel().select(node,!0);var store=GridManager.Tracking_numberGrid.getStore(),filter=(store.getProxy().extraParams.sessiontoken,{});filter.file_id=fileid,store.filterMap.containsKey("file_id")?store.filterMap.replace("file_id",fileid):store.filterMap.add("file_id",fileid),store.getProxy().extraParams.filter=Ext.JSON.encode(filter),store.loadPage(1,{callback:function(records,operation,success){if(WindowManager.Tracking_numberWin&&""!=WindowManager.Tracking_numberWin){var f=WindowManager.Tracking_numberWin.down("#formId");f.getForm().reset(),WindowManager.Tracking_numberWin.down("#file_id").setValue(fileid)}var menuID=GridManager.Tracking_numberGrid.down("#menuID");menuID.setText(menuID.filterParam.text),menuID.setTooltip(menuID.filterParam.text),menuID.menu.items.items[0].setChecked(!0)}})},GridManager.CreateAttachFileGrid=function(param){var tmpArr=[{text:"文件编号",dataIndex:"file_id",renderer:function(value,metaData,record){return 1==record.data.import_status?"<span onclick='GridManager.AttachFileGridSerachfor_file_id("+value+")'>"+value+"&nbsp;<img src='/dist/image/toolbar/NewDoc.png' style='margin-bottom: -2px;height:14px;'></span>":value},flex:1},{text:"原文件名",dataIndex:"file_name",renderer:GlobalFun.UpdateRecord,flex:1},{text:"服务器文件名",dataIndex:"file_save_name",renderer:GlobalFun.UpdateRecord,flex:1},{text:"文件大小",dataIndex:"file_size",renderer:GlobalFun.UpdateRecord,flex:1},{text:"操作人",dataIndex:"admin_name",renderer:GlobalFun.UpdateRecord,flex:1},{text:"验证状态",dataIndex:"validate_status",renderer:function(value){return 1==value?"验证通过":2==value?"验证未通过":"未验证"},flex:1},{text:"导入状态",dataIndex:"import_status",renderer:function(value){return 0==value?"未导入":"已导入"},flex:1},{text:"导入时间",dataIndex:"import_time",renderer:GlobalFun.UpdateRecord,flex:1},{text:"创建时间",dataIndex:"created_at",renderer:GlobalFun.UpdateRecord,flex:1}];return GridManager.AttachFileGrid=Ext.create("chl.gird.AttachFileGrid",GridManager.BaseGridCfg("AttachFileGrid","AttachFileGridState",tmpArr)),param&&param.needLoad&&GridManager.AttachFileGrid.loadGrid(),GridManager.AttachFileGrid},GridManager.SetAttachFileGridSelectionChangeEvent=function(param){GridManager.AttachFileGrid.on("selectionchange",function(view,seles,op){!seles[0]})};
//# sourceMappingURL=AttachFileGrid.js.map